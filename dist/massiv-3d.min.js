!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var r=n();for(var e in r)("object"==typeof exports?exports:t)[e]=r[e]}}(window,function(){return function(t){var n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)r.d(e,o,function(n){return t[n]}.bind(null,o));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=4)}({4:function(t,n,r){"use strict";r.r(n);var e={};r.r(e),r.d(e,"create",function(){return h}),r.d(e,"fromMat4",function(){return d}),r.d(e,"clone",function(){return M}),r.d(e,"copy",function(){return v}),r.d(e,"fromValues",function(){return m}),r.d(e,"set",function(){return p}),r.d(e,"identity",function(){return b}),r.d(e,"transpose",function(){return y}),r.d(e,"invert",function(){return g}),r.d(e,"adjoint",function(){return x}),r.d(e,"determinant",function(){return S}),r.d(e,"multiply",function(){return O}),r.d(e,"translate",function(){return E}),r.d(e,"rotate",function(){return _}),r.d(e,"scale",function(){return w}),r.d(e,"fromTranslation",function(){return P}),r.d(e,"fromRotation",function(){return T}),r.d(e,"fromScaling",function(){return A}),r.d(e,"fromMat2d",function(){return R}),r.d(e,"fromQuat",function(){return j}),r.d(e,"normalFromMat4",function(){return I}),r.d(e,"projection",function(){return C}),r.d(e,"str",function(){return B}),r.d(e,"frob",function(){return F}),r.d(e,"add",function(){return D}),r.d(e,"subtract",function(){return N}),r.d(e,"multiplyScalar",function(){return k}),r.d(e,"multiplyScalarAndAdd",function(){return L}),r.d(e,"exactEquals",function(){return q}),r.d(e,"equals",function(){return U}),r.d(e,"mul",function(){return V}),r.d(e,"sub",function(){return z});var o={};r.r(o),r.d(o,"create",function(){return H}),r.d(o,"clone",function(){return Y}),r.d(o,"copy",function(){return X}),r.d(o,"fromValues",function(){return Q}),r.d(o,"set",function(){return G}),r.d(o,"identity",function(){return W}),r.d(o,"transpose",function(){return Z}),r.d(o,"invert",function(){return K}),r.d(o,"adjoint",function(){return J}),r.d(o,"determinant",function(){return $}),r.d(o,"multiply",function(){return tt}),r.d(o,"translate",function(){return nt}),r.d(o,"scale",function(){return rt}),r.d(o,"rotate",function(){return et}),r.d(o,"rotateX",function(){return ot}),r.d(o,"rotateY",function(){return at}),r.d(o,"rotateZ",function(){return ut}),r.d(o,"fromTranslation",function(){return it}),r.d(o,"fromScaling",function(){return ct}),r.d(o,"fromRotation",function(){return ft}),r.d(o,"fromXRotation",function(){return st}),r.d(o,"fromYRotation",function(){return lt}),r.d(o,"fromZRotation",function(){return ht}),r.d(o,"fromRotationTranslation",function(){return dt}),r.d(o,"fromQuat2",function(){return Mt}),r.d(o,"getTranslation",function(){return vt}),r.d(o,"getScaling",function(){return mt}),r.d(o,"getRotation",function(){return pt}),r.d(o,"fromRotationTranslationScale",function(){return bt}),r.d(o,"fromRotationTranslationScaleOrigin",function(){return yt}),r.d(o,"fromQuat",function(){return gt}),r.d(o,"frustum",function(){return xt}),r.d(o,"perspective",function(){return St}),r.d(o,"perspectiveFromFieldOfView",function(){return Ot}),r.d(o,"ortho",function(){return Et}),r.d(o,"lookAt",function(){return _t}),r.d(o,"targetTo",function(){return wt}),r.d(o,"str",function(){return Pt}),r.d(o,"frob",function(){return Tt}),r.d(o,"add",function(){return At}),r.d(o,"subtract",function(){return Rt}),r.d(o,"multiplyScalar",function(){return jt}),r.d(o,"multiplyScalarAndAdd",function(){return It}),r.d(o,"exactEquals",function(){return Ct}),r.d(o,"equals",function(){return Bt}),r.d(o,"mul",function(){return Ft}),r.d(o,"sub",function(){return Dt});var a={};r.r(a),r.d(a,"create",function(){return Nt}),r.d(a,"clone",function(){return kt}),r.d(a,"length",function(){return Lt}),r.d(a,"fromValues",function(){return qt}),r.d(a,"copy",function(){return Ut}),r.d(a,"set",function(){return Vt}),r.d(a,"add",function(){return zt}),r.d(a,"subtract",function(){return Ht}),r.d(a,"multiply",function(){return Yt}),r.d(a,"divide",function(){return Xt}),r.d(a,"ceil",function(){return Qt}),r.d(a,"floor",function(){return Gt}),r.d(a,"min",function(){return Wt}),r.d(a,"max",function(){return Zt}),r.d(a,"round",function(){return Kt}),r.d(a,"scale",function(){return Jt}),r.d(a,"scaleAndAdd",function(){return $t}),r.d(a,"distance",function(){return tn}),r.d(a,"squaredDistance",function(){return nn}),r.d(a,"squaredLength",function(){return rn}),r.d(a,"negate",function(){return en}),r.d(a,"inverse",function(){return on}),r.d(a,"normalize",function(){return an}),r.d(a,"dot",function(){return un}),r.d(a,"cross",function(){return cn}),r.d(a,"lerp",function(){return fn}),r.d(a,"hermite",function(){return sn}),r.d(a,"bezier",function(){return ln}),r.d(a,"random",function(){return hn}),r.d(a,"transformMat4",function(){return dn}),r.d(a,"transformMat3",function(){return Mn}),r.d(a,"transformQuat",function(){return vn}),r.d(a,"rotateX",function(){return mn}),r.d(a,"rotateY",function(){return pn}),r.d(a,"rotateZ",function(){return bn}),r.d(a,"angle",function(){return yn}),r.d(a,"zero",function(){return gn}),r.d(a,"str",function(){return xn}),r.d(a,"exactEquals",function(){return Sn}),r.d(a,"equals",function(){return On}),r.d(a,"sub",function(){return _n}),r.d(a,"mul",function(){return wn}),r.d(a,"div",function(){return Pn}),r.d(a,"dist",function(){return Tn}),r.d(a,"sqrDist",function(){return An}),r.d(a,"len",function(){return Rn}),r.d(a,"sqrLen",function(){return jn}),r.d(a,"forEach",function(){return In});var u={};function i(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}r.r(u),r.d(u,"create",function(){return Fn}),r.d(u,"identity",function(){return Dn}),r.d(u,"setAxisAngle",function(){return Nn}),r.d(u,"getAxisAngle",function(){return kn}),r.d(u,"multiply",function(){return Ln}),r.d(u,"rotateX",function(){return qn}),r.d(u,"rotateY",function(){return Un}),r.d(u,"rotateZ",function(){return Vn}),r.d(u,"calculateW",function(){return zn}),r.d(u,"slerp",function(){return Hn}),r.d(u,"random",function(){return Yn}),r.d(u,"invert",function(){return Xn}),r.d(u,"conjugate",function(){return Qn}),r.d(u,"fromMat3",function(){return Gn}),r.d(u,"fromEuler",function(){return Wn}),r.d(u,"str",function(){return Zn}),r.d(u,"clone",function(){return er}),r.d(u,"fromValues",function(){return or}),r.d(u,"copy",function(){return ar}),r.d(u,"set",function(){return ur}),r.d(u,"add",function(){return ir}),r.d(u,"mul",function(){return cr}),r.d(u,"scale",function(){return fr}),r.d(u,"dot",function(){return sr}),r.d(u,"lerp",function(){return lr}),r.d(u,"length",function(){return hr}),r.d(u,"len",function(){return dr}),r.d(u,"squaredLength",function(){return Mr}),r.d(u,"sqrLen",function(){return vr}),r.d(u,"normalize",function(){return mr}),r.d(u,"exactEquals",function(){return pr}),r.d(u,"equals",function(){return br}),r.d(u,"rotationTo",function(){return yr}),r.d(u,"sqlerp",function(){return gr}),r.d(u,"setAxes",function(){return xr});var c=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.name,e=n.indices;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=r,this.indices=e||[]}var n,r,e;return n=t,(r=[{key:"getIndicesBuffer",value:function(){return new Uint32Array(this.indices)}},{key:"getIndicesLength",value:function(){return this.indices.length}}])&&i(n.prototype,r),e&&i(n,e),t}(),f=1e-6,s="undefined"!=typeof Float32Array?Float32Array:Array,l=Math.random;Math.PI;function h(){var t=new s(9);return s!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function d(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t}function M(t){var n=new s(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function v(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function m(t,n,r,e,o,a,u,i,c){var f=new s(9);return f[0]=t,f[1]=n,f[2]=r,f[3]=e,f[4]=o,f[5]=a,f[6]=u,f[7]=i,f[8]=c,f}function p(t,n,r,e,o,a,u,i,c,f){return t[0]=n,t[1]=r,t[2]=e,t[3]=o,t[4]=a,t[5]=u,t[6]=i,t[7]=c,t[8]=f,t}function b(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function y(t,n){if(t===n){var r=n[1],e=n[2],o=n[5];t[1]=n[3],t[2]=n[6],t[3]=r,t[5]=n[7],t[6]=e,t[7]=o}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t}function g(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],u=n[4],i=n[5],c=n[6],f=n[7],s=n[8],l=s*u-i*f,h=-s*a+i*c,d=f*a-u*c,M=r*l+e*h+o*d;return M?(M=1/M,t[0]=l*M,t[1]=(-s*e+o*f)*M,t[2]=(i*e-o*u)*M,t[3]=h*M,t[4]=(s*r-o*c)*M,t[5]=(-i*r+o*a)*M,t[6]=d*M,t[7]=(-f*r+e*c)*M,t[8]=(u*r-e*a)*M,t):null}function x(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],u=n[4],i=n[5],c=n[6],f=n[7],s=n[8];return t[0]=u*s-i*f,t[1]=o*f-e*s,t[2]=e*i-o*u,t[3]=i*c-a*s,t[4]=r*s-o*c,t[5]=o*a-r*i,t[6]=a*f-u*c,t[7]=e*c-r*f,t[8]=r*u-e*a,t}function S(t){var n=t[0],r=t[1],e=t[2],o=t[3],a=t[4],u=t[5],i=t[6],c=t[7],f=t[8];return n*(f*a-u*c)+r*(-f*o+u*i)+e*(c*o-a*i)}function O(t,n,r){var e=n[0],o=n[1],a=n[2],u=n[3],i=n[4],c=n[5],f=n[6],s=n[7],l=n[8],h=r[0],d=r[1],M=r[2],v=r[3],m=r[4],p=r[5],b=r[6],y=r[7],g=r[8];return t[0]=h*e+d*u+M*f,t[1]=h*o+d*i+M*s,t[2]=h*a+d*c+M*l,t[3]=v*e+m*u+p*f,t[4]=v*o+m*i+p*s,t[5]=v*a+m*c+p*l,t[6]=b*e+y*u+g*f,t[7]=b*o+y*i+g*s,t[8]=b*a+y*c+g*l,t}function E(t,n,r){var e=n[0],o=n[1],a=n[2],u=n[3],i=n[4],c=n[5],f=n[6],s=n[7],l=n[8],h=r[0],d=r[1];return t[0]=e,t[1]=o,t[2]=a,t[3]=u,t[4]=i,t[5]=c,t[6]=h*e+d*u+f,t[7]=h*o+d*i+s,t[8]=h*a+d*c+l,t}function _(t,n,r){var e=n[0],o=n[1],a=n[2],u=n[3],i=n[4],c=n[5],f=n[6],s=n[7],l=n[8],h=Math.sin(r),d=Math.cos(r);return t[0]=d*e+h*u,t[1]=d*o+h*i,t[2]=d*a+h*c,t[3]=d*u-h*e,t[4]=d*i-h*o,t[5]=d*c-h*a,t[6]=f,t[7]=s,t[8]=l,t}function w(t,n,r){var e=r[0],o=r[1];return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=o*n[3],t[4]=o*n[4],t[5]=o*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function P(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t}function T(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=0,t[3]=-r,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function A(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function R(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t}function j(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],u=r+r,i=e+e,c=o+o,f=r*u,s=e*u,l=e*i,h=o*u,d=o*i,M=o*c,v=a*u,m=a*i,p=a*c;return t[0]=1-l-M,t[3]=s-p,t[6]=h+m,t[1]=s+p,t[4]=1-f-M,t[7]=d-v,t[2]=h-m,t[5]=d+v,t[8]=1-f-l,t}function I(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],u=n[4],i=n[5],c=n[6],f=n[7],s=n[8],l=n[9],h=n[10],d=n[11],M=n[12],v=n[13],m=n[14],p=n[15],b=r*i-e*u,y=r*c-o*u,g=r*f-a*u,x=e*c-o*i,S=e*f-a*i,O=o*f-a*c,E=s*v-l*M,_=s*m-h*M,w=s*p-d*M,P=l*m-h*v,T=l*p-d*v,A=h*p-d*m,R=b*A-y*T+g*P+x*w-S*_+O*E;return R?(R=1/R,t[0]=(i*A-c*T+f*P)*R,t[1]=(c*w-u*A-f*_)*R,t[2]=(u*T-i*w+f*E)*R,t[3]=(o*T-e*A-a*P)*R,t[4]=(r*A-o*w+a*_)*R,t[5]=(e*w-r*T-a*E)*R,t[6]=(v*O-m*S+p*x)*R,t[7]=(m*g-M*O-p*y)*R,t[8]=(M*S-v*g+p*b)*R,t):null}function C(t,n,r){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function B(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function F(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function D(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t}function N(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t}function k(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t}function L(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t[6]=n[6]+r[6]*e,t[7]=n[7]+r[7]*e,t[8]=n[8]+r[8]*e,t}function q(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]}function U(t,n){var r=t[0],e=t[1],o=t[2],a=t[3],u=t[4],i=t[5],c=t[6],s=t[7],l=t[8],h=n[0],d=n[1],M=n[2],v=n[3],m=n[4],p=n[5],b=n[6],y=n[7],g=n[8];return Math.abs(r-h)<=f*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(e-d)<=f*Math.max(1,Math.abs(e),Math.abs(d))&&Math.abs(o-M)<=f*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(a-v)<=f*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(u-m)<=f*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(i-p)<=f*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(c-b)<=f*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(s-y)<=f*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(l-g)<=f*Math.max(1,Math.abs(l),Math.abs(g))}var V=O,z=N;function H(){var t=new s(16);return s!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Y(t){var n=new s(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function X(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function Q(t,n,r,e,o,a,u,i,c,f,l,h,d,M,v,m){var p=new s(16);return p[0]=t,p[1]=n,p[2]=r,p[3]=e,p[4]=o,p[5]=a,p[6]=u,p[7]=i,p[8]=c,p[9]=f,p[10]=l,p[11]=h,p[12]=d,p[13]=M,p[14]=v,p[15]=m,p}function G(t,n,r,e,o,a,u,i,c,f,s,l,h,d,M,v,m){return t[0]=n,t[1]=r,t[2]=e,t[3]=o,t[4]=a,t[5]=u,t[6]=i,t[7]=c,t[8]=f,t[9]=s,t[10]=l,t[11]=h,t[12]=d,t[13]=M,t[14]=v,t[15]=m,t}function W(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Z(t,n){if(t===n){var r=n[1],e=n[2],o=n[3],a=n[6],u=n[7],i=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=r,t[6]=n[9],t[7]=n[13],t[8]=e,t[9]=a,t[11]=n[14],t[12]=o,t[13]=u,t[14]=i}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t}function K(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],u=n[4],i=n[5],c=n[6],f=n[7],s=n[8],l=n[9],h=n[10],d=n[11],M=n[12],v=n[13],m=n[14],p=n[15],b=r*i-e*u,y=r*c-o*u,g=r*f-a*u,x=e*c-o*i,S=e*f-a*i,O=o*f-a*c,E=s*v-l*M,_=s*m-h*M,w=s*p-d*M,P=l*m-h*v,T=l*p-d*v,A=h*p-d*m,R=b*A-y*T+g*P+x*w-S*_+O*E;return R?(R=1/R,t[0]=(i*A-c*T+f*P)*R,t[1]=(o*T-e*A-a*P)*R,t[2]=(v*O-m*S+p*x)*R,t[3]=(h*S-l*O-d*x)*R,t[4]=(c*w-u*A-f*_)*R,t[5]=(r*A-o*w+a*_)*R,t[6]=(m*g-M*O-p*y)*R,t[7]=(s*O-h*g+d*y)*R,t[8]=(u*T-i*w+f*E)*R,t[9]=(e*w-r*T-a*E)*R,t[10]=(M*S-v*g+p*b)*R,t[11]=(l*g-s*S-d*b)*R,t[12]=(i*_-u*P-c*E)*R,t[13]=(r*P-e*_+o*E)*R,t[14]=(v*y-M*x-m*b)*R,t[15]=(s*x-l*y+h*b)*R,t):null}function J(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],u=n[4],i=n[5],c=n[6],f=n[7],s=n[8],l=n[9],h=n[10],d=n[11],M=n[12],v=n[13],m=n[14],p=n[15];return t[0]=i*(h*p-d*m)-l*(c*p-f*m)+v*(c*d-f*h),t[1]=-(e*(h*p-d*m)-l*(o*p-a*m)+v*(o*d-a*h)),t[2]=e*(c*p-f*m)-i*(o*p-a*m)+v*(o*f-a*c),t[3]=-(e*(c*d-f*h)-i*(o*d-a*h)+l*(o*f-a*c)),t[4]=-(u*(h*p-d*m)-s*(c*p-f*m)+M*(c*d-f*h)),t[5]=r*(h*p-d*m)-s*(o*p-a*m)+M*(o*d-a*h),t[6]=-(r*(c*p-f*m)-u*(o*p-a*m)+M*(o*f-a*c)),t[7]=r*(c*d-f*h)-u*(o*d-a*h)+s*(o*f-a*c),t[8]=u*(l*p-d*v)-s*(i*p-f*v)+M*(i*d-f*l),t[9]=-(r*(l*p-d*v)-s*(e*p-a*v)+M*(e*d-a*l)),t[10]=r*(i*p-f*v)-u*(e*p-a*v)+M*(e*f-a*i),t[11]=-(r*(i*d-f*l)-u*(e*d-a*l)+s*(e*f-a*i)),t[12]=-(u*(l*m-h*v)-s*(i*m-c*v)+M*(i*h-c*l)),t[13]=r*(l*m-h*v)-s*(e*m-o*v)+M*(e*h-o*l),t[14]=-(r*(i*m-c*v)-u*(e*m-o*v)+M*(e*c-o*i)),t[15]=r*(i*h-c*l)-u*(e*h-o*l)+s*(e*c-o*i),t}function $(t){var n=t[0],r=t[1],e=t[2],o=t[3],a=t[4],u=t[5],i=t[6],c=t[7],f=t[8],s=t[9],l=t[10],h=t[11],d=t[12],M=t[13],v=t[14],m=t[15];return(n*u-r*a)*(l*m-h*v)-(n*i-e*a)*(s*m-h*M)+(n*c-o*a)*(s*v-l*M)+(r*i-e*u)*(f*m-h*d)-(r*c-o*u)*(f*v-l*d)+(e*c-o*i)*(f*M-s*d)}function tt(t,n,r){var e=n[0],o=n[1],a=n[2],u=n[3],i=n[4],c=n[5],f=n[6],s=n[7],l=n[8],h=n[9],d=n[10],M=n[11],v=n[12],m=n[13],p=n[14],b=n[15],y=r[0],g=r[1],x=r[2],S=r[3];return t[0]=y*e+g*i+x*l+S*v,t[1]=y*o+g*c+x*h+S*m,t[2]=y*a+g*f+x*d+S*p,t[3]=y*u+g*s+x*M+S*b,y=r[4],g=r[5],x=r[6],S=r[7],t[4]=y*e+g*i+x*l+S*v,t[5]=y*o+g*c+x*h+S*m,t[6]=y*a+g*f+x*d+S*p,t[7]=y*u+g*s+x*M+S*b,y=r[8],g=r[9],x=r[10],S=r[11],t[8]=y*e+g*i+x*l+S*v,t[9]=y*o+g*c+x*h+S*m,t[10]=y*a+g*f+x*d+S*p,t[11]=y*u+g*s+x*M+S*b,y=r[12],g=r[13],x=r[14],S=r[15],t[12]=y*e+g*i+x*l+S*v,t[13]=y*o+g*c+x*h+S*m,t[14]=y*a+g*f+x*d+S*p,t[15]=y*u+g*s+x*M+S*b,t}function nt(t,n,r){var e,o,a,u,i,c,f,s,l,h,d,M,v=r[0],m=r[1],p=r[2];return n===t?(t[12]=n[0]*v+n[4]*m+n[8]*p+n[12],t[13]=n[1]*v+n[5]*m+n[9]*p+n[13],t[14]=n[2]*v+n[6]*m+n[10]*p+n[14],t[15]=n[3]*v+n[7]*m+n[11]*p+n[15]):(e=n[0],o=n[1],a=n[2],u=n[3],i=n[4],c=n[5],f=n[6],s=n[7],l=n[8],h=n[9],d=n[10],M=n[11],t[0]=e,t[1]=o,t[2]=a,t[3]=u,t[4]=i,t[5]=c,t[6]=f,t[7]=s,t[8]=l,t[9]=h,t[10]=d,t[11]=M,t[12]=e*v+i*m+l*p+n[12],t[13]=o*v+c*m+h*p+n[13],t[14]=a*v+f*m+d*p+n[14],t[15]=u*v+s*m+M*p+n[15]),t}function rt(t,n,r){var e=r[0],o=r[1],a=r[2];return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*o,t[5]=n[5]*o,t[6]=n[6]*o,t[7]=n[7]*o,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=n[11]*a,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function et(t,n,r,e){var o,a,u,i,c,s,l,h,d,M,v,m,p,b,y,g,x,S,O,E,_,w,P,T,A=e[0],R=e[1],j=e[2],I=Math.sqrt(A*A+R*R+j*j);return I<f?null:(A*=I=1/I,R*=I,j*=I,o=Math.sin(r),u=1-(a=Math.cos(r)),i=n[0],c=n[1],s=n[2],l=n[3],h=n[4],d=n[5],M=n[6],v=n[7],m=n[8],p=n[9],b=n[10],y=n[11],g=A*A*u+a,x=R*A*u+j*o,S=j*A*u-R*o,O=A*R*u-j*o,E=R*R*u+a,_=j*R*u+A*o,w=A*j*u+R*o,P=R*j*u-A*o,T=j*j*u+a,t[0]=i*g+h*x+m*S,t[1]=c*g+d*x+p*S,t[2]=s*g+M*x+b*S,t[3]=l*g+v*x+y*S,t[4]=i*O+h*E+m*_,t[5]=c*O+d*E+p*_,t[6]=s*O+M*E+b*_,t[7]=l*O+v*E+y*_,t[8]=i*w+h*P+m*T,t[9]=c*w+d*P+p*T,t[10]=s*w+M*P+b*T,t[11]=l*w+v*P+y*T,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)}function ot(t,n,r){var e=Math.sin(r),o=Math.cos(r),a=n[4],u=n[5],i=n[6],c=n[7],f=n[8],s=n[9],l=n[10],h=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=a*o+f*e,t[5]=u*o+s*e,t[6]=i*o+l*e,t[7]=c*o+h*e,t[8]=f*o-a*e,t[9]=s*o-u*e,t[10]=l*o-i*e,t[11]=h*o-c*e,t}function at(t,n,r){var e=Math.sin(r),o=Math.cos(r),a=n[0],u=n[1],i=n[2],c=n[3],f=n[8],s=n[9],l=n[10],h=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=a*o-f*e,t[1]=u*o-s*e,t[2]=i*o-l*e,t[3]=c*o-h*e,t[8]=a*e+f*o,t[9]=u*e+s*o,t[10]=i*e+l*o,t[11]=c*e+h*o,t}function ut(t,n,r){var e=Math.sin(r),o=Math.cos(r),a=n[0],u=n[1],i=n[2],c=n[3],f=n[4],s=n[5],l=n[6],h=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=a*o+f*e,t[1]=u*o+s*e,t[2]=i*o+l*e,t[3]=c*o+h*e,t[4]=f*o-a*e,t[5]=s*o-u*e,t[6]=l*o-i*e,t[7]=h*o-c*e,t}function it(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ct(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ft(t,n,r){var e,o,a,u=r[0],i=r[1],c=r[2],s=Math.sqrt(u*u+i*i+c*c);return s<f?null:(u*=s=1/s,i*=s,c*=s,e=Math.sin(n),a=1-(o=Math.cos(n)),t[0]=u*u*a+o,t[1]=i*u*a+c*e,t[2]=c*u*a-i*e,t[3]=0,t[4]=u*i*a-c*e,t[5]=i*i*a+o,t[6]=c*i*a+u*e,t[7]=0,t[8]=u*c*a+i*e,t[9]=i*c*a-u*e,t[10]=c*c*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function st(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function lt(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ht(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function dt(t,n,r){var e=n[0],o=n[1],a=n[2],u=n[3],i=e+e,c=o+o,f=a+a,s=e*i,l=e*c,h=e*f,d=o*c,M=o*f,v=a*f,m=u*i,p=u*c,b=u*f;return t[0]=1-(d+v),t[1]=l+b,t[2]=h-p,t[3]=0,t[4]=l-b,t[5]=1-(s+v),t[6]=M+m,t[7]=0,t[8]=h+p,t[9]=M-m,t[10]=1-(s+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Mt(t,n){var r=new s(3),e=-n[0],o=-n[1],a=-n[2],u=n[3],i=n[4],c=n[5],f=n[6],l=n[7],h=e*e+o*o+a*a+u*u;return h>0?(r[0]=2*(i*u+l*e+c*a-f*o)/h,r[1]=2*(c*u+l*o+f*e-i*a)/h,r[2]=2*(f*u+l*a+i*o-c*e)/h):(r[0]=2*(i*u+l*e+c*a-f*o),r[1]=2*(c*u+l*o+f*e-i*a),r[2]=2*(f*u+l*a+i*o-c*e)),dt(t,n,r),t}function vt(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function mt(t,n){var r=n[0],e=n[1],o=n[2],a=n[4],u=n[5],i=n[6],c=n[8],f=n[9],s=n[10];return t[0]=Math.sqrt(r*r+e*e+o*o),t[1]=Math.sqrt(a*a+u*u+i*i),t[2]=Math.sqrt(c*c+f*f+s*s),t}function pt(t,n){var r=n[0]+n[5]+n[10],e=0;return r>0?(e=2*Math.sqrt(r+1),t[3]=.25*e,t[0]=(n[6]-n[9])/e,t[1]=(n[8]-n[2])/e,t[2]=(n[1]-n[4])/e):n[0]>n[5]&&n[0]>n[10]?(e=2*Math.sqrt(1+n[0]-n[5]-n[10]),t[3]=(n[6]-n[9])/e,t[0]=.25*e,t[1]=(n[1]+n[4])/e,t[2]=(n[8]+n[2])/e):n[5]>n[10]?(e=2*Math.sqrt(1+n[5]-n[0]-n[10]),t[3]=(n[8]-n[2])/e,t[0]=(n[1]+n[4])/e,t[1]=.25*e,t[2]=(n[6]+n[9])/e):(e=2*Math.sqrt(1+n[10]-n[0]-n[5]),t[3]=(n[1]-n[4])/e,t[0]=(n[8]+n[2])/e,t[1]=(n[6]+n[9])/e,t[2]=.25*e),t}function bt(t,n,r,e){var o=n[0],a=n[1],u=n[2],i=n[3],c=o+o,f=a+a,s=u+u,l=o*c,h=o*f,d=o*s,M=a*f,v=a*s,m=u*s,p=i*c,b=i*f,y=i*s,g=e[0],x=e[1],S=e[2];return t[0]=(1-(M+m))*g,t[1]=(h+y)*g,t[2]=(d-b)*g,t[3]=0,t[4]=(h-y)*x,t[5]=(1-(l+m))*x,t[6]=(v+p)*x,t[7]=0,t[8]=(d+b)*S,t[9]=(v-p)*S,t[10]=(1-(l+M))*S,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function yt(t,n,r,e,o){var a=n[0],u=n[1],i=n[2],c=n[3],f=a+a,s=u+u,l=i+i,h=a*f,d=a*s,M=a*l,v=u*s,m=u*l,p=i*l,b=c*f,y=c*s,g=c*l,x=e[0],S=e[1],O=e[2],E=o[0],_=o[1],w=o[2],P=(1-(v+p))*x,T=(d+g)*x,A=(M-y)*x,R=(d-g)*S,j=(1-(h+p))*S,I=(m+b)*S,C=(M+y)*O,B=(m-b)*O,F=(1-(h+v))*O;return t[0]=P,t[1]=T,t[2]=A,t[3]=0,t[4]=R,t[5]=j,t[6]=I,t[7]=0,t[8]=C,t[9]=B,t[10]=F,t[11]=0,t[12]=r[0]+E-(P*E+R*_+C*w),t[13]=r[1]+_-(T*E+j*_+B*w),t[14]=r[2]+w-(A*E+I*_+F*w),t[15]=1,t}function gt(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],u=r+r,i=e+e,c=o+o,f=r*u,s=e*u,l=e*i,h=o*u,d=o*i,M=o*c,v=a*u,m=a*i,p=a*c;return t[0]=1-l-M,t[1]=s+p,t[2]=h-m,t[3]=0,t[4]=s-p,t[5]=1-f-M,t[6]=d+v,t[7]=0,t[8]=h+m,t[9]=d-v,t[10]=1-f-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function xt(t,n,r,e,o,a,u){var i=1/(r-n),c=1/(o-e),f=1/(a-u);return t[0]=2*a*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*c,t[6]=0,t[7]=0,t[8]=(r+n)*i,t[9]=(o+e)*c,t[10]=(u+a)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*a*2*f,t[15]=0,t}function St(t,n,r,e,o){var a,u=1/Math.tan(n/2);return t[0]=u/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(a=1/(e-o),t[10]=(o+e)*a,t[14]=2*o*e*a):(t[10]=-1,t[14]=-2*e),t}function Ot(t,n,r,e){var o=Math.tan(n.upDegrees*Math.PI/180),a=Math.tan(n.downDegrees*Math.PI/180),u=Math.tan(n.leftDegrees*Math.PI/180),i=Math.tan(n.rightDegrees*Math.PI/180),c=2/(u+i),f=2/(o+a);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=-(u-i)*c*.5,t[9]=(o-a)*f*.5,t[10]=e/(r-e),t[11]=-1,t[12]=0,t[13]=0,t[14]=e*r/(r-e),t[15]=0,t}function Et(t,n,r,e,o,a,u){var i=1/(n-r),c=1/(e-o),f=1/(a-u);return t[0]=-2*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(n+r)*i,t[13]=(o+e)*c,t[14]=(u+a)*f,t[15]=1,t}function _t(t,n,r,e){var o,a,u,i,c,s,l,h,d,M,v=n[0],m=n[1],p=n[2],b=e[0],y=e[1],g=e[2],x=r[0],S=r[1],O=r[2];return Math.abs(v-x)<f&&Math.abs(m-S)<f&&Math.abs(p-O)<f?W(t):(l=v-x,h=m-S,d=p-O,o=y*(d*=M=1/Math.sqrt(l*l+h*h+d*d))-g*(h*=M),a=g*(l*=M)-b*d,u=b*h-y*l,(M=Math.sqrt(o*o+a*a+u*u))?(o*=M=1/M,a*=M,u*=M):(o=0,a=0,u=0),i=h*u-d*a,c=d*o-l*u,s=l*a-h*o,(M=Math.sqrt(i*i+c*c+s*s))?(i*=M=1/M,c*=M,s*=M):(i=0,c=0,s=0),t[0]=o,t[1]=i,t[2]=l,t[3]=0,t[4]=a,t[5]=c,t[6]=h,t[7]=0,t[8]=u,t[9]=s,t[10]=d,t[11]=0,t[12]=-(o*v+a*m+u*p),t[13]=-(i*v+c*m+s*p),t[14]=-(l*v+h*m+d*p),t[15]=1,t)}function wt(t,n,r,e){var o=n[0],a=n[1],u=n[2],i=e[0],c=e[1],f=e[2],s=o-r[0],l=a-r[1],h=u-r[2],d=s*s+l*l+h*h;d>0&&(s*=d=1/Math.sqrt(d),l*=d,h*=d);var M=c*h-f*l,v=f*s-i*h,m=i*l-c*s;return(d=M*M+v*v+m*m)>0&&(M*=d=1/Math.sqrt(d),v*=d,m*=d),t[0]=M,t[1]=v,t[2]=m,t[3]=0,t[4]=l*m-h*v,t[5]=h*M-s*m,t[6]=s*v-l*M,t[7]=0,t[8]=s,t[9]=l,t[10]=h,t[11]=0,t[12]=o,t[13]=a,t[14]=u,t[15]=1,t}function Pt(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Tt(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function At(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t[9]=n[9]+r[9],t[10]=n[10]+r[10],t[11]=n[11]+r[11],t[12]=n[12]+r[12],t[13]=n[13]+r[13],t[14]=n[14]+r[14],t[15]=n[15]+r[15],t}function Rt(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t[9]=n[9]-r[9],t[10]=n[10]-r[10],t[11]=n[11]-r[11],t[12]=n[12]-r[12],t[13]=n[13]-r[13],t[14]=n[14]-r[14],t[15]=n[15]-r[15],t}function jt(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t[9]=n[9]*r,t[10]=n[10]*r,t[11]=n[11]*r,t[12]=n[12]*r,t[13]=n[13]*r,t[14]=n[14]*r,t[15]=n[15]*r,t}function It(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t[6]=n[6]+r[6]*e,t[7]=n[7]+r[7]*e,t[8]=n[8]+r[8]*e,t[9]=n[9]+r[9]*e,t[10]=n[10]+r[10]*e,t[11]=n[11]+r[11]*e,t[12]=n[12]+r[12]*e,t[13]=n[13]+r[13]*e,t[14]=n[14]+r[14]*e,t[15]=n[15]+r[15]*e,t}function Ct(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]}function Bt(t,n){var r=t[0],e=t[1],o=t[2],a=t[3],u=t[4],i=t[5],c=t[6],s=t[7],l=t[8],h=t[9],d=t[10],M=t[11],v=t[12],m=t[13],p=t[14],b=t[15],y=n[0],g=n[1],x=n[2],S=n[3],O=n[4],E=n[5],_=n[6],w=n[7],P=n[8],T=n[9],A=n[10],R=n[11],j=n[12],I=n[13],C=n[14],B=n[15];return Math.abs(r-y)<=f*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(e-g)<=f*Math.max(1,Math.abs(e),Math.abs(g))&&Math.abs(o-x)<=f*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-S)<=f*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(u-O)<=f*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(i-E)<=f*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(c-_)<=f*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(s-w)<=f*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(l-P)<=f*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(h-T)<=f*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(d-A)<=f*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(M-R)<=f*Math.max(1,Math.abs(M),Math.abs(R))&&Math.abs(v-j)<=f*Math.max(1,Math.abs(v),Math.abs(j))&&Math.abs(m-I)<=f*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(p-C)<=f*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(b-B)<=f*Math.max(1,Math.abs(b),Math.abs(B))}var Ft=tt,Dt=Rt;function Nt(){var t=new s(3);return s!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function kt(t){var n=new s(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function Lt(t){var n=t[0],r=t[1],e=t[2];return Math.sqrt(n*n+r*r+e*e)}function qt(t,n,r){var e=new s(3);return e[0]=t,e[1]=n,e[2]=r,e}function Ut(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function Vt(t,n,r,e){return t[0]=n,t[1]=r,t[2]=e,t}function zt(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function Ht(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t}function Yt(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t}function Xt(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t}function Qt(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t}function Gt(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t}function Wt(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t}function Zt(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t}function Kt(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t}function Jt(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t}function $t(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t}function tn(t,n){var r=n[0]-t[0],e=n[1]-t[1],o=n[2]-t[2];return Math.sqrt(r*r+e*e+o*o)}function nn(t,n){var r=n[0]-t[0],e=n[1]-t[1],o=n[2]-t[2];return r*r+e*e+o*o}function rn(t){var n=t[0],r=t[1],e=t[2];return n*n+r*r+e*e}function en(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function on(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t}function an(t,n){var r=n[0],e=n[1],o=n[2],a=r*r+e*e+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t}function un(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function cn(t,n,r){var e=n[0],o=n[1],a=n[2],u=r[0],i=r[1],c=r[2];return t[0]=o*c-a*i,t[1]=a*u-e*c,t[2]=e*i-o*u,t}function fn(t,n,r,e){var o=n[0],a=n[1],u=n[2];return t[0]=o+e*(r[0]-o),t[1]=a+e*(r[1]-a),t[2]=u+e*(r[2]-u),t}function sn(t,n,r,e,o,a){var u=a*a,i=u*(2*a-3)+1,c=u*(a-2)+a,f=u*(a-1),s=u*(3-2*a);return t[0]=n[0]*i+r[0]*c+e[0]*f+o[0]*s,t[1]=n[1]*i+r[1]*c+e[1]*f+o[1]*s,t[2]=n[2]*i+r[2]*c+e[2]*f+o[2]*s,t}function ln(t,n,r,e,o,a){var u=1-a,i=u*u,c=a*a,f=i*u,s=3*a*i,l=3*c*u,h=c*a;return t[0]=n[0]*f+r[0]*s+e[0]*l+o[0]*h,t[1]=n[1]*f+r[1]*s+e[1]*l+o[1]*h,t[2]=n[2]*f+r[2]*s+e[2]*l+o[2]*h,t}function hn(t,n){n=n||1;var r=2*l()*Math.PI,e=2*l()-1,o=Math.sqrt(1-e*e)*n;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=e*n,t}function dn(t,n,r){var e=n[0],o=n[1],a=n[2],u=r[3]*e+r[7]*o+r[11]*a+r[15];return u=u||1,t[0]=(r[0]*e+r[4]*o+r[8]*a+r[12])/u,t[1]=(r[1]*e+r[5]*o+r[9]*a+r[13])/u,t[2]=(r[2]*e+r[6]*o+r[10]*a+r[14])/u,t}function Mn(t,n,r){var e=n[0],o=n[1],a=n[2];return t[0]=e*r[0]+o*r[3]+a*r[6],t[1]=e*r[1]+o*r[4]+a*r[7],t[2]=e*r[2]+o*r[5]+a*r[8],t}function vn(t,n,r){var e=r[0],o=r[1],a=r[2],u=r[3],i=n[0],c=n[1],f=n[2],s=o*f-a*c,l=a*i-e*f,h=e*c-o*i,d=o*h-a*l,M=a*s-e*h,v=e*l-o*s,m=2*u;return s*=m,l*=m,h*=m,d*=2,M*=2,v*=2,t[0]=i+s+d,t[1]=c+l+M,t[2]=f+h+v,t}function mn(t,n,r,e){var o=[],a=[];return o[0]=n[0]-r[0],o[1]=n[1]-r[1],o[2]=n[2]-r[2],a[0]=o[0],a[1]=o[1]*Math.cos(e)-o[2]*Math.sin(e),a[2]=o[1]*Math.sin(e)+o[2]*Math.cos(e),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function pn(t,n,r,e){var o=[],a=[];return o[0]=n[0]-r[0],o[1]=n[1]-r[1],o[2]=n[2]-r[2],a[0]=o[2]*Math.sin(e)+o[0]*Math.cos(e),a[1]=o[1],a[2]=o[2]*Math.cos(e)-o[0]*Math.sin(e),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function bn(t,n,r,e){var o=[],a=[];return o[0]=n[0]-r[0],o[1]=n[1]-r[1],o[2]=n[2]-r[2],a[0]=o[0]*Math.cos(e)-o[1]*Math.sin(e),a[1]=o[0]*Math.sin(e)+o[1]*Math.cos(e),a[2]=o[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function yn(t,n){var r=qt(t[0],t[1],t[2]),e=qt(n[0],n[1],n[2]);an(r,r),an(e,e);var o=un(r,e);return o>1?0:o<-1?Math.PI:Math.acos(o)}function gn(t){return t[0]=0,t[1]=0,t[2]=0,t}function xn(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Sn(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}function On(t,n){var r=t[0],e=t[1],o=t[2],a=n[0],u=n[1],i=n[2];return Math.abs(r-a)<=f*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(e-u)<=f*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(o-i)<=f*Math.max(1,Math.abs(o),Math.abs(i))}var En,_n=Ht,wn=Yt,Pn=Xt,Tn=tn,An=nn,Rn=Lt,jn=rn,In=(En=Nt(),function(t,n,r,e,o,a){var u,i;for(n||(n=3),r||(r=0),i=e?Math.min(e*n+r,t.length):t.length,u=r;u<i;u+=n)En[0]=t[u],En[1]=t[u+1],En[2]=t[u+2],o(En,En,a),t[u]=En[0],t[u+1]=En[1],t[u+2]=En[2];return t});function Cn(t){var n=t[0],r=t[1],e=t[2],o=t[3];return Math.sqrt(n*n+r*r+e*e+o*o)}function Bn(t){var n=t[0],r=t[1],e=t[2],o=t[3];return n*n+r*r+e*e+o*o}!function(){var t,n=(t=new s(4),s!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function Fn(){var t=new s(4);return s!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Dn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Nn(t,n,r){r*=.5;var e=Math.sin(r);return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=Math.cos(r),t}function kn(t,n){var r=2*Math.acos(n[3]),e=Math.sin(r/2);return e>f?(t[0]=n[0]/e,t[1]=n[1]/e,t[2]=n[2]/e):(t[0]=1,t[1]=0,t[2]=0),r}function Ln(t,n,r){var e=n[0],o=n[1],a=n[2],u=n[3],i=r[0],c=r[1],f=r[2],s=r[3];return t[0]=e*s+u*i+o*f-a*c,t[1]=o*s+u*c+a*i-e*f,t[2]=a*s+u*f+e*c-o*i,t[3]=u*s-e*i-o*c-a*f,t}function qn(t,n,r){r*=.5;var e=n[0],o=n[1],a=n[2],u=n[3],i=Math.sin(r),c=Math.cos(r);return t[0]=e*c+u*i,t[1]=o*c+a*i,t[2]=a*c-o*i,t[3]=u*c-e*i,t}function Un(t,n,r){r*=.5;var e=n[0],o=n[1],a=n[2],u=n[3],i=Math.sin(r),c=Math.cos(r);return t[0]=e*c-a*i,t[1]=o*c+u*i,t[2]=a*c+e*i,t[3]=u*c-o*i,t}function Vn(t,n,r){r*=.5;var e=n[0],o=n[1],a=n[2],u=n[3],i=Math.sin(r),c=Math.cos(r);return t[0]=e*c+o*i,t[1]=o*c-e*i,t[2]=a*c+u*i,t[3]=u*c-a*i,t}function zn(t,n){var r=n[0],e=n[1],o=n[2];return t[0]=r,t[1]=e,t[2]=o,t[3]=Math.sqrt(Math.abs(1-r*r-e*e-o*o)),t}function Hn(t,n,r,e){var o,a,u,i,c,s=n[0],l=n[1],h=n[2],d=n[3],M=r[0],v=r[1],m=r[2],p=r[3];return(a=s*M+l*v+h*m+d*p)<0&&(a=-a,M=-M,v=-v,m=-m,p=-p),1-a>f?(o=Math.acos(a),u=Math.sin(o),i=Math.sin((1-e)*o)/u,c=Math.sin(e*o)/u):(i=1-e,c=e),t[0]=i*s+c*M,t[1]=i*l+c*v,t[2]=i*h+c*m,t[3]=i*d+c*p,t}function Yn(t){var n=l(),r=l(),e=l(),o=Math.sqrt(1-n),a=Math.sqrt(n);return t[0]=o*Math.sin(2*Math.PI*r),t[1]=o*Math.cos(2*Math.PI*r),t[2]=a*Math.sin(2*Math.PI*e),t[3]=a*Math.cos(2*Math.PI*e),t}function Xn(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],u=r*r+e*e+o*o+a*a,i=u?1/u:0;return t[0]=-r*i,t[1]=-e*i,t[2]=-o*i,t[3]=a*i,t}function Qn(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function Gn(t,n){var r,e=n[0]+n[4]+n[8];if(e>0)r=Math.sqrt(e+1),t[3]=.5*r,r=.5/r,t[0]=(n[5]-n[7])*r,t[1]=(n[6]-n[2])*r,t[2]=(n[1]-n[3])*r;else{var o=0;n[4]>n[0]&&(o=1),n[8]>n[3*o+o]&&(o=2);var a=(o+1)%3,u=(o+2)%3;r=Math.sqrt(n[3*o+o]-n[3*a+a]-n[3*u+u]+1),t[o]=.5*r,r=.5/r,t[3]=(n[3*a+u]-n[3*u+a])*r,t[a]=(n[3*a+o]+n[3*o+a])*r,t[u]=(n[3*u+o]+n[3*o+u])*r}return t}function Wn(t,n,r,e){var o=.5*Math.PI/180;n*=o,r*=o,e*=o;var a=Math.sin(n),u=Math.cos(n),i=Math.sin(r),c=Math.cos(r),f=Math.sin(e),s=Math.cos(e);return t[0]=a*c*s-u*i*f,t[1]=u*i*s+a*c*f,t[2]=u*c*f-a*i*s,t[3]=u*c*s+a*i*f,t}function Zn(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Kn,Jn,$n,tr,nr,rr,er=function(t){var n=new s(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},or=function(t,n,r,e){var o=new s(4);return o[0]=t,o[1]=n,o[2]=r,o[3]=e,o},ar=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},ur=function(t,n,r,e,o){return t[0]=n,t[1]=r,t[2]=e,t[3]=o,t},ir=function(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t},cr=Ln,fr=function(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t},sr=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]},lr=function(t,n,r,e){var o=n[0],a=n[1],u=n[2],i=n[3];return t[0]=o+e*(r[0]-o),t[1]=a+e*(r[1]-a),t[2]=u+e*(r[2]-u),t[3]=i+e*(r[3]-i),t},hr=Cn,dr=hr,Mr=Bn,vr=Mr,mr=function(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],u=r*r+e*e+o*o+a*a;return u>0&&(u=1/Math.sqrt(u)),t[0]=r*u,t[1]=e*u,t[2]=o*u,t[3]=a*u,t},pr=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]},br=function(t,n){var r=t[0],e=t[1],o=t[2],a=t[3],u=n[0],i=n[1],c=n[2],s=n[3];return Math.abs(r-u)<=f*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(e-i)<=f*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(o-c)<=f*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-s)<=f*Math.max(1,Math.abs(a),Math.abs(s))},yr=(Kn=Nt(),Jn=qt(1,0,0),$n=qt(0,1,0),function(t,n,r){var e=un(n,r);return e<-.999999?(cn(Kn,Jn,n),Rn(Kn)<1e-6&&cn(Kn,$n,n),an(Kn,Kn),Nn(t,Kn,Math.PI),t):e>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(cn(Kn,n,r),t[0]=Kn[0],t[1]=Kn[1],t[2]=Kn[2],t[3]=1+e,mr(t,t))}),gr=(tr=Fn(),nr=Fn(),function(t,n,r,e,o,a){return Hn(tr,n,o,a),Hn(nr,r,e,a),Hn(t,tr,nr,2*a*(1-a)),t}),xr=(rr=h(),function(t,n,r,e){return rr[0]=r[0],rr[3]=r[1],rr[6]=r[2],rr[1]=e[0],rr[4]=e[1],rr[7]=e[2],rr[2]=-n[0],rr[5]=-n[1],rr[8]=-n[2],mr(t,Gn(t,rr))}),Sr={createVec3:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return a.fromValues(t,n,r)},createQuat:function(t,n,r,e){return u.fromValues(t,n,r,e)},createMat4:function(){return o.create()},addVec3:function(t,n,r){return a.add(t,n,r)},quatFromEuler:function(t,n,r,e){return u.fromEuler(t,n,r,e)},multiplyQuat:function(t,n,r){return u.multiply(t,n,r)},mat4LookAt:function(t,n,r,e){return o.lookAt(t,n,r,e)},mat4Perspective:function(t,n,r,e,a){return o.perspective(t,n,r,e,a)},mat4Ortho:function(t,n,r,e,a,u,i){return o.ortho(t,n,r,e,a,u,i)},copyMat4:function(t,n){return o.copy(t,n)},multiplyMat4:function(t,n,r){return o.multiply(t,n,r)},mat4FromQuatPosScl:function(t,n,r,e){return o.fromRotationTranslationScale(t,n,r,e)},normalMatFromMat4:function(t,n){return e.normalFromMat4(t,n)},createMat3:function(){return e.create()}};function Or(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Er(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var _r=function(){function t(n,r,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.domNode=n,this.scene=r,this.camera=e,this.createAndAppendCanvas(),this.gl=this.canvas.getContext("webgl2")}var n,r,e;return n=t,(r=[{key:"createAndAppendCanvas",value:function(){this.canvas=document.createElement("canvas"),this.domNode.appendChild(this.canvas),this.canvas.style.position="relative",this.canvas.style.top="0px",this.canvas.style.left="0px",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.width=this.domNode.clientWidth,this.canvas.height=this.domNode.clientHeight}},{key:"resize",value:function(){this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.gl.viewport(0,0,this.canvas.width,this.canvas.height)}},{key:"createShader",value:function(t,n){var r=this.gl,e=r.createShader(t);if(r.shaderSource(e,n),r.compileShader(e),r.getShaderParameter(e,r.COMPILE_STATUS))return e;console.error(r.getShaderInfoLog(e)),r.deleteShader(e)}},{key:"createProgram",value:function(t,n){var r=this.gl,e=r.createProgram();if(r.attachShader(e,t),r.attachShader(e,n),r.linkProgram(e),r.getProgramParameter(e,r.LINK_STATUS))return e;console.error(r.getProgramInfoLog(e)),r.deleteProgram(e)}},{key:"createTexture",value:function(t){var n=this.gl,r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r);var e=n.RGBA,o=n.RGBA,a=n.UNSIGNED_BYTE;return n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,e,o,a,t),n.generateMipmap(n.TEXTURE_2D),r}},{key:"createArrayBuffer",value:function(n,r){var e,o=this.gl,a=(Or(e={},t.BUFFER_TYPE_POSITION,function(n){return{loc:t.SHADER_POSITION_LOCATION,bufferData:n.getPositionsBuffer(),bufferSize:n.getPositionsBufferSize()}}),Or(e,t.BUFFER_TYPE_NORMAL,function(n){return{loc:t.SHADER_NORMAL_LOCATION,bufferData:n.getNormalsBuffer(),bufferSize:n.getNormalsBufferSize()}}),Or(e,t.BUFFER_TYPE_UV,function(n){return{loc:t.SHADER_UV_LOCATION,bufferData:n.getUvsBuffer(),bufferSize:n.getUvsBufferSize()}}),Or(e,t.BUFFER_TYPE_VERTEXCOLOR,function(n){return{loc:t.SHADER_VERTEXCOLOR_LOCATION,bufferData:n.getVertexColorsBuffer(),bufferSize:n.getVertexColorsBufferSize()}}),e)[n](r),u=a.loc,i=a.bufferData,c=a.bufferSize,f=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,f),o.bufferData(o.ARRAY_BUFFER,i,o.STATIC_DRAW),o.enableVertexAttribArray(u),o.vertexAttribPointer(u,c,o.FLOAT,!1,0,0)}},{key:"createVertexArray",value:function(n){var r=this.gl,e=r.createVertexArray();return r.bindVertexArray(e),n.positions.length>0&&this.createArrayBuffer(t.BUFFER_TYPE_POSITION,n),n.normals.length>0&&this.createArrayBuffer(t.BUFFER_TYPE_NORMAL,n),n.uvs.length>0&&this.createArrayBuffer(t.BUFFER_TYPE_UV,n),n.vertexColors.length>0&&this.createArrayBuffer(t.BUFFER_TYPE_VERTEXCOLOR,n),e}},{key:"createElementArrayBuffer",value:function(t){var n=this.gl,r=n.createBuffer();return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.getIndicesBuffer(),n.STATIC_DRAW),r}},{key:"init",value:function(){var t=this,n=this.gl;n.viewport(0,0,n.canvas.width,n.canvas.height),n.clearColor(0,0,0,1),n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL);var r=this.scene.getChildren({recursive:!0}).meshes;this.meshBuffers=[];for(var e=function(e){var o=r[e],a=o.geometry,u=o.materials[0];t.meshBuffers[e]={modelMatrix:o.modelMatrix,indicesLength:u.getIndicesLength(),material:u},t.meshBuffers[e].vao=t.createVertexArray(a),t.meshBuffers[e].elementIndexBuffer=t.createElementArrayBuffer(u);var i=u.getShaderSource(),c=i.vertexShaderSource,f=i.fragmentShaderSource,s=i.uniforms,l=i.textures,h=t.createShader(n.VERTEX_SHADER,c),d=t.createShader(n.FRAGMENT_SHADER,f);t.meshBuffers[e].shader=t.createProgram(h,d);var M=function(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},e=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.forEach(function(n){Or(t,n,r[n])})}return t}({},s.vertexShader,s.fragmentShader);t.meshBuffers[e].uniforms=Object.keys(M).filter(function(t){return M[t]}).reduce(function(r,o){return r[o]=n.getUniformLocation(t.meshBuffers[e].shader,o),r},{}),t.meshBuffers[e].textures=Object.keys(l).reduce(function(n,r){return n[r]=t.createTexture(l[r]),n},{})},o=0;o<r.length;o++)e(o)}},{key:"render",value:function(){var t=this.gl;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.scene.computeModelMatrix();for(var n=0;n<this.meshBuffers.length;n++){var r=this.meshBuffers[n];t.bindVertexArray(r.vao),t.useProgram(r.shader);var e=Object.keys(r.uniforms),o=Object.keys(r.textures),a=Sr.multiplyMat4(Sr.createMat4(),this.camera.viewMatrix,r.modelMatrix),u=Sr.multiplyMat4(Sr.createMat4(),this.camera.projectionMatrix,a),i=Sr.normalMatFromMat4(Sr.createMat3(),a);e.includes("modelMatrix")&&t.uniformMatrix4fv(r.uniforms.modelMatrix,!1,r.modelMatrix),e.includes("viewMatrix")&&t.uniformMatrix4fv(r.uniforms.viewMatrix,!1,this.camera.viewMatrix),e.includes("projectionMatrix")&&t.uniformMatrix4fv(r.uniforms.projectionMatrix,!1,this.camera.projectionMatrix),e.includes("normalMatrix")&&t.uniformMatrix3fv(r.uniforms.normalMatrix,!1,i),e.includes("modelViewProjectionMatrix")&&t.uniformMatrix4fv(r.uniforms.modelViewProjectionMatrix,!1,u),e.includes("diffuseTexture")&&o.includes("diffuseTexture")&&(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r.textures.diffuseTexture),t.uniform1i(r.uniforms.diffuseTexture,0)),e.includes("cameraPosition")&&t.uniform3fv(r.uniforms.cameraPosition,this.camera.position),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.elementIndexBuffer),t.drawElements(t.TRIANGLES,r.indicesLength,t.UNSIGNED_INT,0)}}}])&&Er(n.prototype,r),e&&Er(n,e),t}();_r.SHADER_POSITION_LOCATION=0,_r.SHADER_NORMAL_LOCATION=1,_r.SHADER_UV_LOCATION=2,_r.SHADER_VERTEXCOLOR_LOCATION=3,_r.BUFFER_TYPE_POSITION="position",_r.BUFFER_TYPE_NORMAL="normal",_r.BUFFER_TYPE_UV="uv",_r.BUFFER_TYPE_VERTEXCOLOR="vertexColor",_r.SHADER_PRECISION_HIGH="highp",_r.SHADER_PRECISION_MEDIUM="mediump",_r.SHADER_PRECISION_LOW="lowp",_r.SHADER_FLOAT_PRECISION=_r.SHADER_PRECISION_MEDIUM,_r.SHADER_INT_PRECISION=_r.SHADER_PRECISION_MEDIUM;var wr=_r;function Pr(t){return(Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tr(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function Ar(t,n){return!n||"object"!==Pr(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function Rr(t){return(Rr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jr(t,n){return(jr=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var Ir=function(t){return Object.keys(t).filter(function(n){return t[n]}).map(function(n){return"uniform ".concat(t[n]," ").concat(n,";")}).join("\n")},Cr=function(t){function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.name,o=r.indices,a=r.diffuseTexture;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(t=Ar(this,Rr(n).call(this,{name:e,indices:o}))).ambientColor=[],t.diffuseColor=[],t.specularColor=[],t.specularExponent=0,t.diffuseTexture=a,t}var r,e,o;return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&jr(t,n)}(n,c),r=n,(e=[{key:"getShaderSource",value:function(){var t=this.diffuseTexture,n={vertexShader:{modelMatrix:"mat4",normalMatrix:"mat3",modelViewProjectionMatrix:"mat4"},fragmentShader:{diffuseTexture:t?"sampler2D":void 0,cameraPosition:"vec3"}},r={diffuseTexture:t},e="\n            precision ".concat(wr.SHADER_FLOAT_PRECISION," float;\n            precision ").concat(wr.SHADER_INT_PRECISION," int;\n\n            layout(location = ").concat(wr.SHADER_POSITION_LOCATION,") in vec3 position;\n            layout(location = ").concat(wr.SHADER_NORMAL_LOCATION,") in vec3 normal;\n            layout(location = ").concat(wr.SHADER_UV_LOCATION,") in vec2 uv;\n\n            ").concat(Ir(n.vertexShader),"\n\n            out vec3 vPosition;\n            out vec3 vNormal;\n            out vec2 vUv;\n\n            void main() {\n                vUv = uv;\n                vNormal = normalMatrix * normal;\n                vPosition = (modelMatrix * vec4( position, 1.0 )).xyz;\n                gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);\n            }\n        "),o="\n            precision ".concat(wr.SHADER_FLOAT_PRECISION," float;\n            precision ").concat(wr.SHADER_INT_PRECISION," int;\n\n            in vec3 vPosition;\n            in vec3 vNormal;\n            in vec2 vUv;\n\n            ").concat(Ir(n.fragmentShader),"\n\n            vec4 specularColor;\n            float specularAmount;\n            float specularShininess;\n\n            vec3 light;\n\n            out vec4 fragmentColor;\n\n            void main() {\n                specularColor = vec4(1.0, 1.0, 1.0, 1.0);\n                specularAmount = 0.5;\n                specularShininess = 50.0;\n                light = normalize(vec3(5.0, 5.0, 5.0));\n\n                vec3 directionToCamera = normalize(cameraPosition - vPosition);\n                vec3 halfwayVector = normalize( directionToCamera + light );\n\n                float specularBrightness = (\n                specularAmount *\n                pow(\n                    max(0.0, dot(vNormal, halfwayVector)),\n                    specularShininess\n                )\n                );\n\n                float lightDotProduct = dot( normalize(vNormal), light );\n                float surfaceBrightness = max( 0.0, lightDotProduct );\n                vec4 texelColor = texture(diffuseTexture, vUv);\n\n                fragmentColor = vec4(texelColor.rgb * surfaceBrightness + specularColor.xyz * specularBrightness, texelColor.a);\n            }\n        ");return{vertexShaderSource:"".concat("#version 300 es\n\n").concat(e),fragmentShaderSource:"".concat("#version 300 es\n\n").concat(o),uniforms:n,textures:r}}}])&&Tr(r.prototype,e),o&&Tr(r,o),n}();function Br(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var Fr=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.positions,e=n.normals,o=n.uvs,a=n.vertexColors;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.positions=r||[],this.normals=e||[],this.uvs=o||[],this.vertexColors=a||[],this.positionsSize=3,this.normalsSize=3,this.uvsSize=2,this.vertexColorsSize=4}var n,r,e;return n=t,(r=[{key:"getPositionsBuffer",value:function(){return new Float32Array(this.positions)}},{key:"getPositionsBufferSize",value:function(){return this.positionsSize}},{key:"getNormalsBuffer",value:function(){return new Float32Array(this.normals)}},{key:"getNormalsBufferSize",value:function(){return this.normalsSize}},{key:"getUvsBuffer",value:function(){return new Float32Array(this.uvs)}},{key:"getUvsBufferSize",value:function(){return this.uvsSize}},{key:"getVertexColorsBuffer",value:function(){return new Float32Array(this.vertexColors)}},{key:"getVertexColorsBufferSize",value:function(){return this.vertexColorsSize}}])&&Br(n.prototype,r),e&&Br(n,e),t}(),Dr={load:function(t){var n=new Image;return new Promise(function(r){n.onload=function(){return r(n)},n.src=t})}};function Nr(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var kr=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.parent=null,this.children=[],this.position=Sr.createVec3(),this.scaling=Sr.createVec3(1,1,1),this.quaternion=Sr.createQuat(0,0,0,1),this.transformDirty=!1,this.modelMatrix=Sr.createMat4()}var n,r,e;return n=t,(r=[{key:"addChild",value:function(t){t.parent=this,this.children.push(t)}},{key:"getChildren",value:function(){for(var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).recursive,n=[],r=0;r<this.children.length;r++){var e=this.children[r];if(n.push(e),t){var o=e.getChildren({recursive:t});n=n.concat(o)}}return n}},{key:"translate",value:function(t,n,r){this.position=Sr.addVec3(this.position,this.position,Sr.createVec3(t,n,r)),this.transformDirty=!0}},{key:"scale",value:function(t,n,r){this.scaling=Sr.addVec3(this.scaling,this.scaling,Sr.createVec3(t,n,r)),this.transformDirty=!0}},{key:"rotate",value:function(t,n,r){var e=Sr.quatFromEuler(Sr.createQuat(),t,n,r);this.quaternion=Sr.multiplyQuat(this.quaternion,this.quaternion,e),this.transformDirty=!0}},{key:"computeModelMatrix",value:function(t){var n=this.position,r=this.scaling,e=this.quaternion;if(t)if(this.transformDirty){var o=Sr.mat4FromQuatPosScl(Sr.createMat4(),e,n,r);this.modelMatrix=Sr.multiplyMat4(this.modelMatrix,t,o)}else this.modelMatrix=Sr.multiplyMat4(this.modelMatrix,t,this.modelMatrix);else this.transformDirty&&(this.modelMatrix=Sr.mat4FromQuatPosScl(this.modelMatrix,e,n,r));for(var a=0;a<this.children.length;a++)t||this.transformDirty?this.children[a].computeModelMatrix(this.modelMatrix):this.children[a].computeModelMatrix()}}])&&Nr(n.prototype,r),e&&Nr(n,e),t}();function Lr(t){return(Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qr(t,n){return!n||"object"!==Lr(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function Ur(t){return(Ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vr(t,n){return(Vr=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var zr=function(t){function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.name,o=r.geometry,a=r.materials;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(t=qr(this,Ur(n).call(this))).name=e,t.geometry=o,t.materials=a,t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&Vr(t,n)}(n,kr),n}();function Hr(t){return(Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yr(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function Xr(t,n){return!n||"object"!==Hr(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function Qr(t){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gr(t,n){return(Gr=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var Wr=function(t){function n(){var t;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(t=Xr(this,Qr(n).call(this))).upVector=Sr.createVec3(0,1,0),t.viewMatrix=Sr.createMat4(),t.projectionMatrix=Sr.createMat4(),t}var r,e,o;return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&Gr(t,n)}(n,kr),r=n,(e=[{key:"lookAt",value:function(t,n,r){this.viewMatrix=Sr.mat4LookAt(this.viewMatrix,this.position,Sr.createVec3(t,n,r),this.upVector)}}])&&Yr(r.prototype,e),o&&Yr(r,o),n}();function Zr(t){return(Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kr(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function Jr(t,n){return!n||"object"!==Zr(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function $r(t){return($r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function te(t,n){return(te=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var ne=function(t){function n(t,r,e,o,a,u){var i;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(i=Jr(this,$r(n).call(this))).left=t,i.right=r,i.bottom=e,i.top=o,i.near=a,i.far=u,i.updateProjectionMatrix(t,r,e,o,a,u),i}var r,e,o;return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&te(t,n)}(n,Wr),r=n,(e=[{key:"updateProjectionMatrix",value:function(t,n,r,e,o,a){this.left=t,this.right=n,this.bottom=r,this.top=e,this.near=o,this.far=a,this.projectionMatrix=Sr.mat4Ortho(this.projectionMatrix,t,n,r,e,o,a)}}])&&Kr(r.prototype,e),o&&Kr(r,o),n}();function re(t){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ee(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function oe(t,n){return!n||"object"!==re(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function ae(t){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ue(t,n){return(ue=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var ie=function(t){function n(t,r,e,o){var a;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(a=oe(this,ae(n).call(this))).fov=t,a.aspect=r,a.near=e,a.far=o,a.updateProjectionMatrix(t,r,e,o),a}var r,e,o;return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&ue(t,n)}(n,Wr),r=n,(e=[{key:"updateProjectionMatrix",value:function(t,n,r,e){this.fov=t,this.aspect=n,this.near=r,this.far=e,this.projectionMatrix=Sr.mat4Perspective(this.projectionMatrix,t,n,r,e)}}])&&ee(r.prototype,e),o&&ee(r,o),n}();function ce(t){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fe(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function se(t,n){return!n||"object"!==ce(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function le(t){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function he(t,n){return(he=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var de=function(t){function n(){return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),se(this,le(n).apply(this,arguments))}var r,e,o;return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&he(t,n)}(n,kr),r=n,(e=[{key:"getChildren",value:function(){for(var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).recursive,n=[],r=0;r<this.children.length;r++){var e=this.children[r];if(n.push(e),t){var o=e.getChildren({recursive:t});n=n.concat(o)}}for(var a=[],u=0;u<n.length;u++)n[u]instanceof zr&&a.push(n[u]);return{meshes:a}}}])&&fe(r.prototype,e),o&&fe(r,o),n}();r.d(n,"MASSIV",function(){return Me});var Me={BlinnPhongMaterial:Cr,Geometry:Fr,ImageLoader:Dr,Material:c,MathUtils:Sr,Mesh:zr,Node:kr,OrthographicCamera:ne,PerspectiveCamera:ie,Scene:de,WebGLRenderer:wr}}})});