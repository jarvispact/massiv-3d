!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var r=n();for(var e in r)("object"==typeof exports?exports:t)[e]=r[e]}}(window,function(){return function(t){var n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)r.d(e,o,function(n){return t[n]}.bind(null,o));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=4)}({4:function(t,n,r){"use strict";r.r(n);var e={};r.r(e),r.d(e,"create",function(){return g}),r.d(e,"fromMat4",function(){return x}),r.d(e,"clone",function(){return S}),r.d(e,"copy",function(){return _}),r.d(e,"fromValues",function(){return E}),r.d(e,"set",function(){return O}),r.d(e,"identity",function(){return w}),r.d(e,"transpose",function(){return P}),r.d(e,"invert",function(){return T}),r.d(e,"adjoint",function(){return A}),r.d(e,"determinant",function(){return R}),r.d(e,"multiply",function(){return C}),r.d(e,"translate",function(){return j}),r.d(e,"rotate",function(){return I}),r.d(e,"scale",function(){return L}),r.d(e,"fromTranslation",function(){return D}),r.d(e,"fromRotation",function(){return F}),r.d(e,"fromScaling",function(){return B}),r.d(e,"fromMat2d",function(){return N}),r.d(e,"fromQuat",function(){return U}),r.d(e,"normalFromMat4",function(){return q}),r.d(e,"projection",function(){return k}),r.d(e,"str",function(){return V}),r.d(e,"frob",function(){return z}),r.d(e,"add",function(){return H}),r.d(e,"subtract",function(){return Y}),r.d(e,"multiplyScalar",function(){return X}),r.d(e,"multiplyScalarAndAdd",function(){return G}),r.d(e,"exactEquals",function(){return W}),r.d(e,"equals",function(){return Q}),r.d(e,"mul",function(){return Z}),r.d(e,"sub",function(){return K});var o={};r.r(o),r.d(o,"create",function(){return J}),r.d(o,"clone",function(){return $}),r.d(o,"copy",function(){return tt}),r.d(o,"fromValues",function(){return nt}),r.d(o,"set",function(){return rt}),r.d(o,"identity",function(){return et}),r.d(o,"transpose",function(){return ot}),r.d(o,"invert",function(){return at}),r.d(o,"adjoint",function(){return it}),r.d(o,"determinant",function(){return ut}),r.d(o,"multiply",function(){return ct}),r.d(o,"translate",function(){return ft}),r.d(o,"scale",function(){return st}),r.d(o,"rotate",function(){return ht}),r.d(o,"rotateX",function(){return lt}),r.d(o,"rotateY",function(){return dt}),r.d(o,"rotateZ",function(){return vt}),r.d(o,"fromTranslation",function(){return Mt}),r.d(o,"fromScaling",function(){return mt}),r.d(o,"fromRotation",function(){return pt}),r.d(o,"fromXRotation",function(){return bt}),r.d(o,"fromYRotation",function(){return yt}),r.d(o,"fromZRotation",function(){return gt}),r.d(o,"fromRotationTranslation",function(){return xt}),r.d(o,"fromQuat2",function(){return St}),r.d(o,"getTranslation",function(){return _t}),r.d(o,"getScaling",function(){return Et}),r.d(o,"getRotation",function(){return Ot}),r.d(o,"fromRotationTranslationScale",function(){return wt}),r.d(o,"fromRotationTranslationScaleOrigin",function(){return Pt}),r.d(o,"fromQuat",function(){return Tt}),r.d(o,"frustum",function(){return At}),r.d(o,"perspective",function(){return Rt}),r.d(o,"perspectiveFromFieldOfView",function(){return Ct}),r.d(o,"ortho",function(){return jt}),r.d(o,"lookAt",function(){return It}),r.d(o,"targetTo",function(){return Lt}),r.d(o,"str",function(){return Dt}),r.d(o,"frob",function(){return Ft}),r.d(o,"add",function(){return Bt}),r.d(o,"subtract",function(){return Nt}),r.d(o,"multiplyScalar",function(){return Ut}),r.d(o,"multiplyScalarAndAdd",function(){return qt}),r.d(o,"exactEquals",function(){return kt}),r.d(o,"equals",function(){return Vt}),r.d(o,"mul",function(){return zt}),r.d(o,"sub",function(){return Ht});var a={};r.r(a),r.d(a,"create",function(){return Yt}),r.d(a,"clone",function(){return Xt}),r.d(a,"length",function(){return Gt}),r.d(a,"fromValues",function(){return Wt}),r.d(a,"copy",function(){return Qt}),r.d(a,"set",function(){return Zt}),r.d(a,"add",function(){return Kt}),r.d(a,"subtract",function(){return Jt}),r.d(a,"multiply",function(){return $t}),r.d(a,"divide",function(){return tn}),r.d(a,"ceil",function(){return nn}),r.d(a,"floor",function(){return rn}),r.d(a,"min",function(){return en}),r.d(a,"max",function(){return on}),r.d(a,"round",function(){return an}),r.d(a,"scale",function(){return un}),r.d(a,"scaleAndAdd",function(){return cn}),r.d(a,"distance",function(){return fn}),r.d(a,"squaredDistance",function(){return sn}),r.d(a,"squaredLength",function(){return hn}),r.d(a,"negate",function(){return ln}),r.d(a,"inverse",function(){return dn}),r.d(a,"normalize",function(){return vn}),r.d(a,"dot",function(){return Mn}),r.d(a,"cross",function(){return mn}),r.d(a,"lerp",function(){return pn}),r.d(a,"hermite",function(){return bn}),r.d(a,"bezier",function(){return yn}),r.d(a,"random",function(){return gn}),r.d(a,"transformMat4",function(){return xn}),r.d(a,"transformMat3",function(){return Sn}),r.d(a,"transformQuat",function(){return _n}),r.d(a,"rotateX",function(){return En}),r.d(a,"rotateY",function(){return On}),r.d(a,"rotateZ",function(){return wn}),r.d(a,"angle",function(){return Pn}),r.d(a,"zero",function(){return Tn}),r.d(a,"str",function(){return An}),r.d(a,"exactEquals",function(){return Rn}),r.d(a,"equals",function(){return Cn}),r.d(a,"sub",function(){return In}),r.d(a,"mul",function(){return Ln}),r.d(a,"div",function(){return Dn}),r.d(a,"dist",function(){return Fn}),r.d(a,"sqrDist",function(){return Bn}),r.d(a,"len",function(){return Nn}),r.d(a,"sqrLen",function(){return Un}),r.d(a,"forEach",function(){return qn});var i={};function u(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}r.r(i),r.d(i,"create",function(){return zn}),r.d(i,"identity",function(){return Hn}),r.d(i,"setAxisAngle",function(){return Yn}),r.d(i,"getAxisAngle",function(){return Xn}),r.d(i,"multiply",function(){return Gn}),r.d(i,"rotateX",function(){return Wn}),r.d(i,"rotateY",function(){return Qn}),r.d(i,"rotateZ",function(){return Zn}),r.d(i,"calculateW",function(){return Kn}),r.d(i,"slerp",function(){return Jn}),r.d(i,"random",function(){return $n}),r.d(i,"invert",function(){return tr}),r.d(i,"conjugate",function(){return nr}),r.d(i,"fromMat3",function(){return rr}),r.d(i,"fromEuler",function(){return er}),r.d(i,"str",function(){return or}),r.d(i,"clone",function(){return hr}),r.d(i,"fromValues",function(){return lr}),r.d(i,"copy",function(){return dr}),r.d(i,"set",function(){return vr}),r.d(i,"add",function(){return Mr}),r.d(i,"mul",function(){return mr}),r.d(i,"scale",function(){return pr}),r.d(i,"dot",function(){return br}),r.d(i,"lerp",function(){return yr}),r.d(i,"length",function(){return gr}),r.d(i,"len",function(){return xr}),r.d(i,"squaredLength",function(){return Sr}),r.d(i,"sqrLen",function(){return _r}),r.d(i,"normalize",function(){return Er}),r.d(i,"exactEquals",function(){return Or}),r.d(i,"equals",function(){return wr}),r.d(i,"rotationTo",function(){return Pr}),r.d(i,"sqlerp",function(){return Tr}),r.d(i,"setAxes",function(){return Ar});var c=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.name,e=n.indices;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=r,this.indices=e||[]}var n,r,e;return n=t,(r=[{key:"getIndicesBuffer",value:function(){return new Uint32Array(this.indices)}},{key:"getIndicesLength",value:function(){return this.indices.length}}])&&u(n.prototype,r),e&&u(n,e),t}();function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,n){return!n||"object"!==f(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,n){return(l=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var d=function(t){function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.name,o=r.indices,a=r.diffuseTexture;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(t=s(this,h(n).call(this,{name:e,indices:o}))).ambientColor=[],t.diffuseColor=[],t.specularColor=[],t.specularExponent=0,t.diffuseTexture=a,t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&l(t,n)}(n,c),n}();function v(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var M=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.positions,e=n.normals,o=n.uvs,a=n.vertexColors;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.positions=r||[],this.normals=e||[],this.uvs=o||[],this.vertexColors=a||[],this.positionsSize=3,this.normalsSize=3,this.uvsSize=2,this.vertexColorsSize=4}var n,r,e;return n=t,(r=[{key:"getPositionsBuffer",value:function(){return new Float32Array(this.positions)}},{key:"getPositionsBufferSize",value:function(){return this.positionsSize}},{key:"getNormalsBuffer",value:function(){return new Float32Array(this.normals)}},{key:"getNormalsBufferSize",value:function(){return this.normalsSize}},{key:"getUvsBuffer",value:function(){return new Float32Array(this.uvs)}},{key:"getUvsBufferSize",value:function(){return this.uvsSize}},{key:"getVertexColorsBuffer",value:function(){return new Float32Array(this.vertexColors)}},{key:"getVertexColorsBufferSize",value:function(){return this.vertexColorsSize}}])&&v(n.prototype,r),e&&v(n,e),t}(),m={load:function(t){var n=new Image;return new Promise(function(r){n.onload=function(){return r(n)},n.src=t})}},p=1e-6,b="undefined"!=typeof Float32Array?Float32Array:Array,y=Math.random;Math.PI;function g(){var t=new b(9);return b!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function x(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t}function S(t){var n=new b(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function _(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function E(t,n,r,e,o,a,i,u,c){var f=new b(9);return f[0]=t,f[1]=n,f[2]=r,f[3]=e,f[4]=o,f[5]=a,f[6]=i,f[7]=u,f[8]=c,f}function O(t,n,r,e,o,a,i,u,c,f){return t[0]=n,t[1]=r,t[2]=e,t[3]=o,t[4]=a,t[5]=i,t[6]=u,t[7]=c,t[8]=f,t}function w(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function P(t,n){if(t===n){var r=n[1],e=n[2],o=n[5];t[1]=n[3],t[2]=n[6],t[3]=r,t[5]=n[7],t[6]=e,t[7]=o}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t}function T(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],i=n[4],u=n[5],c=n[6],f=n[7],s=n[8],h=s*i-u*f,l=-s*a+u*c,d=f*a-i*c,v=r*h+e*l+o*d;return v?(v=1/v,t[0]=h*v,t[1]=(-s*e+o*f)*v,t[2]=(u*e-o*i)*v,t[3]=l*v,t[4]=(s*r-o*c)*v,t[5]=(-u*r+o*a)*v,t[6]=d*v,t[7]=(-f*r+e*c)*v,t[8]=(i*r-e*a)*v,t):null}function A(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],i=n[4],u=n[5],c=n[6],f=n[7],s=n[8];return t[0]=i*s-u*f,t[1]=o*f-e*s,t[2]=e*u-o*i,t[3]=u*c-a*s,t[4]=r*s-o*c,t[5]=o*a-r*u,t[6]=a*f-i*c,t[7]=e*c-r*f,t[8]=r*i-e*a,t}function R(t){var n=t[0],r=t[1],e=t[2],o=t[3],a=t[4],i=t[5],u=t[6],c=t[7],f=t[8];return n*(f*a-i*c)+r*(-f*o+i*u)+e*(c*o-a*u)}function C(t,n,r){var e=n[0],o=n[1],a=n[2],i=n[3],u=n[4],c=n[5],f=n[6],s=n[7],h=n[8],l=r[0],d=r[1],v=r[2],M=r[3],m=r[4],p=r[5],b=r[6],y=r[7],g=r[8];return t[0]=l*e+d*i+v*f,t[1]=l*o+d*u+v*s,t[2]=l*a+d*c+v*h,t[3]=M*e+m*i+p*f,t[4]=M*o+m*u+p*s,t[5]=M*a+m*c+p*h,t[6]=b*e+y*i+g*f,t[7]=b*o+y*u+g*s,t[8]=b*a+y*c+g*h,t}function j(t,n,r){var e=n[0],o=n[1],a=n[2],i=n[3],u=n[4],c=n[5],f=n[6],s=n[7],h=n[8],l=r[0],d=r[1];return t[0]=e,t[1]=o,t[2]=a,t[3]=i,t[4]=u,t[5]=c,t[6]=l*e+d*i+f,t[7]=l*o+d*u+s,t[8]=l*a+d*c+h,t}function I(t,n,r){var e=n[0],o=n[1],a=n[2],i=n[3],u=n[4],c=n[5],f=n[6],s=n[7],h=n[8],l=Math.sin(r),d=Math.cos(r);return t[0]=d*e+l*i,t[1]=d*o+l*u,t[2]=d*a+l*c,t[3]=d*i-l*e,t[4]=d*u-l*o,t[5]=d*c-l*a,t[6]=f,t[7]=s,t[8]=h,t}function L(t,n,r){var e=r[0],o=r[1];return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=o*n[3],t[4]=o*n[4],t[5]=o*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function D(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t}function F(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=0,t[3]=-r,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function B(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function N(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t}function U(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],i=r+r,u=e+e,c=o+o,f=r*i,s=e*i,h=e*u,l=o*i,d=o*u,v=o*c,M=a*i,m=a*u,p=a*c;return t[0]=1-h-v,t[3]=s-p,t[6]=l+m,t[1]=s+p,t[4]=1-f-v,t[7]=d-M,t[2]=l-m,t[5]=d+M,t[8]=1-f-h,t}function q(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],i=n[4],u=n[5],c=n[6],f=n[7],s=n[8],h=n[9],l=n[10],d=n[11],v=n[12],M=n[13],m=n[14],p=n[15],b=r*u-e*i,y=r*c-o*i,g=r*f-a*i,x=e*c-o*u,S=e*f-a*u,_=o*f-a*c,E=s*M-h*v,O=s*m-l*v,w=s*p-d*v,P=h*m-l*M,T=h*p-d*M,A=l*p-d*m,R=b*A-y*T+g*P+x*w-S*O+_*E;return R?(R=1/R,t[0]=(u*A-c*T+f*P)*R,t[1]=(c*w-i*A-f*O)*R,t[2]=(i*T-u*w+f*E)*R,t[3]=(o*T-e*A-a*P)*R,t[4]=(r*A-o*w+a*O)*R,t[5]=(e*w-r*T-a*E)*R,t[6]=(M*_-m*S+p*x)*R,t[7]=(m*g-v*_-p*y)*R,t[8]=(v*S-M*g+p*b)*R,t):null}function k(t,n,r){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function V(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function z(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function H(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t}function Y(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t}function X(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t}function G(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t[6]=n[6]+r[6]*e,t[7]=n[7]+r[7]*e,t[8]=n[8]+r[8]*e,t}function W(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]}function Q(t,n){var r=t[0],e=t[1],o=t[2],a=t[3],i=t[4],u=t[5],c=t[6],f=t[7],s=t[8],h=n[0],l=n[1],d=n[2],v=n[3],M=n[4],m=n[5],b=n[6],y=n[7],g=n[8];return Math.abs(r-h)<=p*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(e-l)<=p*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(o-d)<=p*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-v)<=p*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(i-M)<=p*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(u-m)<=p*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(c-b)<=p*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(f-y)<=p*Math.max(1,Math.abs(f),Math.abs(y))&&Math.abs(s-g)<=p*Math.max(1,Math.abs(s),Math.abs(g))}var Z=C,K=Y;function J(){var t=new b(16);return b!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function $(t){var n=new b(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function tt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function nt(t,n,r,e,o,a,i,u,c,f,s,h,l,d,v,M){var m=new b(16);return m[0]=t,m[1]=n,m[2]=r,m[3]=e,m[4]=o,m[5]=a,m[6]=i,m[7]=u,m[8]=c,m[9]=f,m[10]=s,m[11]=h,m[12]=l,m[13]=d,m[14]=v,m[15]=M,m}function rt(t,n,r,e,o,a,i,u,c,f,s,h,l,d,v,M,m){return t[0]=n,t[1]=r,t[2]=e,t[3]=o,t[4]=a,t[5]=i,t[6]=u,t[7]=c,t[8]=f,t[9]=s,t[10]=h,t[11]=l,t[12]=d,t[13]=v,t[14]=M,t[15]=m,t}function et(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ot(t,n){if(t===n){var r=n[1],e=n[2],o=n[3],a=n[6],i=n[7],u=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=r,t[6]=n[9],t[7]=n[13],t[8]=e,t[9]=a,t[11]=n[14],t[12]=o,t[13]=i,t[14]=u}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t}function at(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],i=n[4],u=n[5],c=n[6],f=n[7],s=n[8],h=n[9],l=n[10],d=n[11],v=n[12],M=n[13],m=n[14],p=n[15],b=r*u-e*i,y=r*c-o*i,g=r*f-a*i,x=e*c-o*u,S=e*f-a*u,_=o*f-a*c,E=s*M-h*v,O=s*m-l*v,w=s*p-d*v,P=h*m-l*M,T=h*p-d*M,A=l*p-d*m,R=b*A-y*T+g*P+x*w-S*O+_*E;return R?(R=1/R,t[0]=(u*A-c*T+f*P)*R,t[1]=(o*T-e*A-a*P)*R,t[2]=(M*_-m*S+p*x)*R,t[3]=(l*S-h*_-d*x)*R,t[4]=(c*w-i*A-f*O)*R,t[5]=(r*A-o*w+a*O)*R,t[6]=(m*g-v*_-p*y)*R,t[7]=(s*_-l*g+d*y)*R,t[8]=(i*T-u*w+f*E)*R,t[9]=(e*w-r*T-a*E)*R,t[10]=(v*S-M*g+p*b)*R,t[11]=(h*g-s*S-d*b)*R,t[12]=(u*O-i*P-c*E)*R,t[13]=(r*P-e*O+o*E)*R,t[14]=(M*y-v*x-m*b)*R,t[15]=(s*x-h*y+l*b)*R,t):null}function it(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],i=n[4],u=n[5],c=n[6],f=n[7],s=n[8],h=n[9],l=n[10],d=n[11],v=n[12],M=n[13],m=n[14],p=n[15];return t[0]=u*(l*p-d*m)-h*(c*p-f*m)+M*(c*d-f*l),t[1]=-(e*(l*p-d*m)-h*(o*p-a*m)+M*(o*d-a*l)),t[2]=e*(c*p-f*m)-u*(o*p-a*m)+M*(o*f-a*c),t[3]=-(e*(c*d-f*l)-u*(o*d-a*l)+h*(o*f-a*c)),t[4]=-(i*(l*p-d*m)-s*(c*p-f*m)+v*(c*d-f*l)),t[5]=r*(l*p-d*m)-s*(o*p-a*m)+v*(o*d-a*l),t[6]=-(r*(c*p-f*m)-i*(o*p-a*m)+v*(o*f-a*c)),t[7]=r*(c*d-f*l)-i*(o*d-a*l)+s*(o*f-a*c),t[8]=i*(h*p-d*M)-s*(u*p-f*M)+v*(u*d-f*h),t[9]=-(r*(h*p-d*M)-s*(e*p-a*M)+v*(e*d-a*h)),t[10]=r*(u*p-f*M)-i*(e*p-a*M)+v*(e*f-a*u),t[11]=-(r*(u*d-f*h)-i*(e*d-a*h)+s*(e*f-a*u)),t[12]=-(i*(h*m-l*M)-s*(u*m-c*M)+v*(u*l-c*h)),t[13]=r*(h*m-l*M)-s*(e*m-o*M)+v*(e*l-o*h),t[14]=-(r*(u*m-c*M)-i*(e*m-o*M)+v*(e*c-o*u)),t[15]=r*(u*l-c*h)-i*(e*l-o*h)+s*(e*c-o*u),t}function ut(t){var n=t[0],r=t[1],e=t[2],o=t[3],a=t[4],i=t[5],u=t[6],c=t[7],f=t[8],s=t[9],h=t[10],l=t[11],d=t[12],v=t[13],M=t[14],m=t[15];return(n*i-r*a)*(h*m-l*M)-(n*u-e*a)*(s*m-l*v)+(n*c-o*a)*(s*M-h*v)+(r*u-e*i)*(f*m-l*d)-(r*c-o*i)*(f*M-h*d)+(e*c-o*u)*(f*v-s*d)}function ct(t,n,r){var e=n[0],o=n[1],a=n[2],i=n[3],u=n[4],c=n[5],f=n[6],s=n[7],h=n[8],l=n[9],d=n[10],v=n[11],M=n[12],m=n[13],p=n[14],b=n[15],y=r[0],g=r[1],x=r[2],S=r[3];return t[0]=y*e+g*u+x*h+S*M,t[1]=y*o+g*c+x*l+S*m,t[2]=y*a+g*f+x*d+S*p,t[3]=y*i+g*s+x*v+S*b,y=r[4],g=r[5],x=r[6],S=r[7],t[4]=y*e+g*u+x*h+S*M,t[5]=y*o+g*c+x*l+S*m,t[6]=y*a+g*f+x*d+S*p,t[7]=y*i+g*s+x*v+S*b,y=r[8],g=r[9],x=r[10],S=r[11],t[8]=y*e+g*u+x*h+S*M,t[9]=y*o+g*c+x*l+S*m,t[10]=y*a+g*f+x*d+S*p,t[11]=y*i+g*s+x*v+S*b,y=r[12],g=r[13],x=r[14],S=r[15],t[12]=y*e+g*u+x*h+S*M,t[13]=y*o+g*c+x*l+S*m,t[14]=y*a+g*f+x*d+S*p,t[15]=y*i+g*s+x*v+S*b,t}function ft(t,n,r){var e,o,a,i,u,c,f,s,h,l,d,v,M=r[0],m=r[1],p=r[2];return n===t?(t[12]=n[0]*M+n[4]*m+n[8]*p+n[12],t[13]=n[1]*M+n[5]*m+n[9]*p+n[13],t[14]=n[2]*M+n[6]*m+n[10]*p+n[14],t[15]=n[3]*M+n[7]*m+n[11]*p+n[15]):(e=n[0],o=n[1],a=n[2],i=n[3],u=n[4],c=n[5],f=n[6],s=n[7],h=n[8],l=n[9],d=n[10],v=n[11],t[0]=e,t[1]=o,t[2]=a,t[3]=i,t[4]=u,t[5]=c,t[6]=f,t[7]=s,t[8]=h,t[9]=l,t[10]=d,t[11]=v,t[12]=e*M+u*m+h*p+n[12],t[13]=o*M+c*m+l*p+n[13],t[14]=a*M+f*m+d*p+n[14],t[15]=i*M+s*m+v*p+n[15]),t}function st(t,n,r){var e=r[0],o=r[1],a=r[2];return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*o,t[5]=n[5]*o,t[6]=n[6]*o,t[7]=n[7]*o,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=n[11]*a,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function ht(t,n,r,e){var o,a,i,u,c,f,s,h,l,d,v,M,m,b,y,g,x,S,_,E,O,w,P,T,A=e[0],R=e[1],C=e[2],j=Math.sqrt(A*A+R*R+C*C);return j<p?null:(A*=j=1/j,R*=j,C*=j,o=Math.sin(r),i=1-(a=Math.cos(r)),u=n[0],c=n[1],f=n[2],s=n[3],h=n[4],l=n[5],d=n[6],v=n[7],M=n[8],m=n[9],b=n[10],y=n[11],g=A*A*i+a,x=R*A*i+C*o,S=C*A*i-R*o,_=A*R*i-C*o,E=R*R*i+a,O=C*R*i+A*o,w=A*C*i+R*o,P=R*C*i-A*o,T=C*C*i+a,t[0]=u*g+h*x+M*S,t[1]=c*g+l*x+m*S,t[2]=f*g+d*x+b*S,t[3]=s*g+v*x+y*S,t[4]=u*_+h*E+M*O,t[5]=c*_+l*E+m*O,t[6]=f*_+d*E+b*O,t[7]=s*_+v*E+y*O,t[8]=u*w+h*P+M*T,t[9]=c*w+l*P+m*T,t[10]=f*w+d*P+b*T,t[11]=s*w+v*P+y*T,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)}function lt(t,n,r){var e=Math.sin(r),o=Math.cos(r),a=n[4],i=n[5],u=n[6],c=n[7],f=n[8],s=n[9],h=n[10],l=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=a*o+f*e,t[5]=i*o+s*e,t[6]=u*o+h*e,t[7]=c*o+l*e,t[8]=f*o-a*e,t[9]=s*o-i*e,t[10]=h*o-u*e,t[11]=l*o-c*e,t}function dt(t,n,r){var e=Math.sin(r),o=Math.cos(r),a=n[0],i=n[1],u=n[2],c=n[3],f=n[8],s=n[9],h=n[10],l=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=a*o-f*e,t[1]=i*o-s*e,t[2]=u*o-h*e,t[3]=c*o-l*e,t[8]=a*e+f*o,t[9]=i*e+s*o,t[10]=u*e+h*o,t[11]=c*e+l*o,t}function vt(t,n,r){var e=Math.sin(r),o=Math.cos(r),a=n[0],i=n[1],u=n[2],c=n[3],f=n[4],s=n[5],h=n[6],l=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=a*o+f*e,t[1]=i*o+s*e,t[2]=u*o+h*e,t[3]=c*o+l*e,t[4]=f*o-a*e,t[5]=s*o-i*e,t[6]=h*o-u*e,t[7]=l*o-c*e,t}function Mt(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function mt(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pt(t,n,r){var e,o,a,i=r[0],u=r[1],c=r[2],f=Math.sqrt(i*i+u*u+c*c);return f<p?null:(i*=f=1/f,u*=f,c*=f,e=Math.sin(n),a=1-(o=Math.cos(n)),t[0]=i*i*a+o,t[1]=u*i*a+c*e,t[2]=c*i*a-u*e,t[3]=0,t[4]=i*u*a-c*e,t[5]=u*u*a+o,t[6]=c*u*a+i*e,t[7]=0,t[8]=i*c*a+u*e,t[9]=u*c*a-i*e,t[10]=c*c*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function bt(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function yt(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gt(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function xt(t,n,r){var e=n[0],o=n[1],a=n[2],i=n[3],u=e+e,c=o+o,f=a+a,s=e*u,h=e*c,l=e*f,d=o*c,v=o*f,M=a*f,m=i*u,p=i*c,b=i*f;return t[0]=1-(d+M),t[1]=h+b,t[2]=l-p,t[3]=0,t[4]=h-b,t[5]=1-(s+M),t[6]=v+m,t[7]=0,t[8]=l+p,t[9]=v-m,t[10]=1-(s+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function St(t,n){var r=new b(3),e=-n[0],o=-n[1],a=-n[2],i=n[3],u=n[4],c=n[5],f=n[6],s=n[7],h=e*e+o*o+a*a+i*i;return h>0?(r[0]=2*(u*i+s*e+c*a-f*o)/h,r[1]=2*(c*i+s*o+f*e-u*a)/h,r[2]=2*(f*i+s*a+u*o-c*e)/h):(r[0]=2*(u*i+s*e+c*a-f*o),r[1]=2*(c*i+s*o+f*e-u*a),r[2]=2*(f*i+s*a+u*o-c*e)),xt(t,n,r),t}function _t(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function Et(t,n){var r=n[0],e=n[1],o=n[2],a=n[4],i=n[5],u=n[6],c=n[8],f=n[9],s=n[10];return t[0]=Math.sqrt(r*r+e*e+o*o),t[1]=Math.sqrt(a*a+i*i+u*u),t[2]=Math.sqrt(c*c+f*f+s*s),t}function Ot(t,n){var r=n[0]+n[5]+n[10],e=0;return r>0?(e=2*Math.sqrt(r+1),t[3]=.25*e,t[0]=(n[6]-n[9])/e,t[1]=(n[8]-n[2])/e,t[2]=(n[1]-n[4])/e):n[0]>n[5]&&n[0]>n[10]?(e=2*Math.sqrt(1+n[0]-n[5]-n[10]),t[3]=(n[6]-n[9])/e,t[0]=.25*e,t[1]=(n[1]+n[4])/e,t[2]=(n[8]+n[2])/e):n[5]>n[10]?(e=2*Math.sqrt(1+n[5]-n[0]-n[10]),t[3]=(n[8]-n[2])/e,t[0]=(n[1]+n[4])/e,t[1]=.25*e,t[2]=(n[6]+n[9])/e):(e=2*Math.sqrt(1+n[10]-n[0]-n[5]),t[3]=(n[1]-n[4])/e,t[0]=(n[8]+n[2])/e,t[1]=(n[6]+n[9])/e,t[2]=.25*e),t}function wt(t,n,r,e){var o=n[0],a=n[1],i=n[2],u=n[3],c=o+o,f=a+a,s=i+i,h=o*c,l=o*f,d=o*s,v=a*f,M=a*s,m=i*s,p=u*c,b=u*f,y=u*s,g=e[0],x=e[1],S=e[2];return t[0]=(1-(v+m))*g,t[1]=(l+y)*g,t[2]=(d-b)*g,t[3]=0,t[4]=(l-y)*x,t[5]=(1-(h+m))*x,t[6]=(M+p)*x,t[7]=0,t[8]=(d+b)*S,t[9]=(M-p)*S,t[10]=(1-(h+v))*S,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Pt(t,n,r,e,o){var a=n[0],i=n[1],u=n[2],c=n[3],f=a+a,s=i+i,h=u+u,l=a*f,d=a*s,v=a*h,M=i*s,m=i*h,p=u*h,b=c*f,y=c*s,g=c*h,x=e[0],S=e[1],_=e[2],E=o[0],O=o[1],w=o[2],P=(1-(M+p))*x,T=(d+g)*x,A=(v-y)*x,R=(d-g)*S,C=(1-(l+p))*S,j=(m+b)*S,I=(v+y)*_,L=(m-b)*_,D=(1-(l+M))*_;return t[0]=P,t[1]=T,t[2]=A,t[3]=0,t[4]=R,t[5]=C,t[6]=j,t[7]=0,t[8]=I,t[9]=L,t[10]=D,t[11]=0,t[12]=r[0]+E-(P*E+R*O+I*w),t[13]=r[1]+O-(T*E+C*O+L*w),t[14]=r[2]+w-(A*E+j*O+D*w),t[15]=1,t}function Tt(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],i=r+r,u=e+e,c=o+o,f=r*i,s=e*i,h=e*u,l=o*i,d=o*u,v=o*c,M=a*i,m=a*u,p=a*c;return t[0]=1-h-v,t[1]=s+p,t[2]=l-m,t[3]=0,t[4]=s-p,t[5]=1-f-v,t[6]=d+M,t[7]=0,t[8]=l+m,t[9]=d-M,t[10]=1-f-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function At(t,n,r,e,o,a,i){var u=1/(r-n),c=1/(o-e),f=1/(a-i);return t[0]=2*a*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*c,t[6]=0,t[7]=0,t[8]=(r+n)*u,t[9]=(o+e)*c,t[10]=(i+a)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*a*2*f,t[15]=0,t}function Rt(t,n,r,e,o){var a,i=1/Math.tan(n/2);return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(a=1/(e-o),t[10]=(o+e)*a,t[14]=2*o*e*a):(t[10]=-1,t[14]=-2*e),t}function Ct(t,n,r,e){var o=Math.tan(n.upDegrees*Math.PI/180),a=Math.tan(n.downDegrees*Math.PI/180),i=Math.tan(n.leftDegrees*Math.PI/180),u=Math.tan(n.rightDegrees*Math.PI/180),c=2/(i+u),f=2/(o+a);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=-(i-u)*c*.5,t[9]=(o-a)*f*.5,t[10]=e/(r-e),t[11]=-1,t[12]=0,t[13]=0,t[14]=e*r/(r-e),t[15]=0,t}function jt(t,n,r,e,o,a,i){var u=1/(n-r),c=1/(e-o),f=1/(a-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(n+r)*u,t[13]=(o+e)*c,t[14]=(i+a)*f,t[15]=1,t}function It(t,n,r,e){var o,a,i,u,c,f,s,h,l,d,v=n[0],M=n[1],m=n[2],b=e[0],y=e[1],g=e[2],x=r[0],S=r[1],_=r[2];return Math.abs(v-x)<p&&Math.abs(M-S)<p&&Math.abs(m-_)<p?et(t):(s=v-x,h=M-S,l=m-_,o=y*(l*=d=1/Math.sqrt(s*s+h*h+l*l))-g*(h*=d),a=g*(s*=d)-b*l,i=b*h-y*s,(d=Math.sqrt(o*o+a*a+i*i))?(o*=d=1/d,a*=d,i*=d):(o=0,a=0,i=0),u=h*i-l*a,c=l*o-s*i,f=s*a-h*o,(d=Math.sqrt(u*u+c*c+f*f))?(u*=d=1/d,c*=d,f*=d):(u=0,c=0,f=0),t[0]=o,t[1]=u,t[2]=s,t[3]=0,t[4]=a,t[5]=c,t[6]=h,t[7]=0,t[8]=i,t[9]=f,t[10]=l,t[11]=0,t[12]=-(o*v+a*M+i*m),t[13]=-(u*v+c*M+f*m),t[14]=-(s*v+h*M+l*m),t[15]=1,t)}function Lt(t,n,r,e){var o=n[0],a=n[1],i=n[2],u=e[0],c=e[1],f=e[2],s=o-r[0],h=a-r[1],l=i-r[2],d=s*s+h*h+l*l;d>0&&(s*=d=1/Math.sqrt(d),h*=d,l*=d);var v=c*l-f*h,M=f*s-u*l,m=u*h-c*s;return(d=v*v+M*M+m*m)>0&&(v*=d=1/Math.sqrt(d),M*=d,m*=d),t[0]=v,t[1]=M,t[2]=m,t[3]=0,t[4]=h*m-l*M,t[5]=l*v-s*m,t[6]=s*M-h*v,t[7]=0,t[8]=s,t[9]=h,t[10]=l,t[11]=0,t[12]=o,t[13]=a,t[14]=i,t[15]=1,t}function Dt(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Ft(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function Bt(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t[9]=n[9]+r[9],t[10]=n[10]+r[10],t[11]=n[11]+r[11],t[12]=n[12]+r[12],t[13]=n[13]+r[13],t[14]=n[14]+r[14],t[15]=n[15]+r[15],t}function Nt(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t[9]=n[9]-r[9],t[10]=n[10]-r[10],t[11]=n[11]-r[11],t[12]=n[12]-r[12],t[13]=n[13]-r[13],t[14]=n[14]-r[14],t[15]=n[15]-r[15],t}function Ut(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t[9]=n[9]*r,t[10]=n[10]*r,t[11]=n[11]*r,t[12]=n[12]*r,t[13]=n[13]*r,t[14]=n[14]*r,t[15]=n[15]*r,t}function qt(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t[6]=n[6]+r[6]*e,t[7]=n[7]+r[7]*e,t[8]=n[8]+r[8]*e,t[9]=n[9]+r[9]*e,t[10]=n[10]+r[10]*e,t[11]=n[11]+r[11]*e,t[12]=n[12]+r[12]*e,t[13]=n[13]+r[13]*e,t[14]=n[14]+r[14]*e,t[15]=n[15]+r[15]*e,t}function kt(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]}function Vt(t,n){var r=t[0],e=t[1],o=t[2],a=t[3],i=t[4],u=t[5],c=t[6],f=t[7],s=t[8],h=t[9],l=t[10],d=t[11],v=t[12],M=t[13],m=t[14],b=t[15],y=n[0],g=n[1],x=n[2],S=n[3],_=n[4],E=n[5],O=n[6],w=n[7],P=n[8],T=n[9],A=n[10],R=n[11],C=n[12],j=n[13],I=n[14],L=n[15];return Math.abs(r-y)<=p*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(e-g)<=p*Math.max(1,Math.abs(e),Math.abs(g))&&Math.abs(o-x)<=p*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-S)<=p*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(i-_)<=p*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(u-E)<=p*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-O)<=p*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(f-w)<=p*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(s-P)<=p*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(h-T)<=p*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(l-A)<=p*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(d-R)<=p*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(v-C)<=p*Math.max(1,Math.abs(v),Math.abs(C))&&Math.abs(M-j)<=p*Math.max(1,Math.abs(M),Math.abs(j))&&Math.abs(m-I)<=p*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(b-L)<=p*Math.max(1,Math.abs(b),Math.abs(L))}var zt=ct,Ht=Nt;function Yt(){var t=new b(3);return b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Xt(t){var n=new b(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function Gt(t){var n=t[0],r=t[1],e=t[2];return Math.sqrt(n*n+r*r+e*e)}function Wt(t,n,r){var e=new b(3);return e[0]=t,e[1]=n,e[2]=r,e}function Qt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function Zt(t,n,r,e){return t[0]=n,t[1]=r,t[2]=e,t}function Kt(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function Jt(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t}function $t(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t}function tn(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t}function nn(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t}function rn(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t}function en(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t}function on(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t}function an(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t}function un(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t}function cn(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t}function fn(t,n){var r=n[0]-t[0],e=n[1]-t[1],o=n[2]-t[2];return Math.sqrt(r*r+e*e+o*o)}function sn(t,n){var r=n[0]-t[0],e=n[1]-t[1],o=n[2]-t[2];return r*r+e*e+o*o}function hn(t){var n=t[0],r=t[1],e=t[2];return n*n+r*r+e*e}function ln(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function dn(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t}function vn(t,n){var r=n[0],e=n[1],o=n[2],a=r*r+e*e+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t}function Mn(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function mn(t,n,r){var e=n[0],o=n[1],a=n[2],i=r[0],u=r[1],c=r[2];return t[0]=o*c-a*u,t[1]=a*i-e*c,t[2]=e*u-o*i,t}function pn(t,n,r,e){var o=n[0],a=n[1],i=n[2];return t[0]=o+e*(r[0]-o),t[1]=a+e*(r[1]-a),t[2]=i+e*(r[2]-i),t}function bn(t,n,r,e,o,a){var i=a*a,u=i*(2*a-3)+1,c=i*(a-2)+a,f=i*(a-1),s=i*(3-2*a);return t[0]=n[0]*u+r[0]*c+e[0]*f+o[0]*s,t[1]=n[1]*u+r[1]*c+e[1]*f+o[1]*s,t[2]=n[2]*u+r[2]*c+e[2]*f+o[2]*s,t}function yn(t,n,r,e,o,a){var i=1-a,u=i*i,c=a*a,f=u*i,s=3*a*u,h=3*c*i,l=c*a;return t[0]=n[0]*f+r[0]*s+e[0]*h+o[0]*l,t[1]=n[1]*f+r[1]*s+e[1]*h+o[1]*l,t[2]=n[2]*f+r[2]*s+e[2]*h+o[2]*l,t}function gn(t,n){n=n||1;var r=2*y()*Math.PI,e=2*y()-1,o=Math.sqrt(1-e*e)*n;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=e*n,t}function xn(t,n,r){var e=n[0],o=n[1],a=n[2],i=r[3]*e+r[7]*o+r[11]*a+r[15];return i=i||1,t[0]=(r[0]*e+r[4]*o+r[8]*a+r[12])/i,t[1]=(r[1]*e+r[5]*o+r[9]*a+r[13])/i,t[2]=(r[2]*e+r[6]*o+r[10]*a+r[14])/i,t}function Sn(t,n,r){var e=n[0],o=n[1],a=n[2];return t[0]=e*r[0]+o*r[3]+a*r[6],t[1]=e*r[1]+o*r[4]+a*r[7],t[2]=e*r[2]+o*r[5]+a*r[8],t}function _n(t,n,r){var e=r[0],o=r[1],a=r[2],i=r[3],u=n[0],c=n[1],f=n[2],s=o*f-a*c,h=a*u-e*f,l=e*c-o*u,d=o*l-a*h,v=a*s-e*l,M=e*h-o*s,m=2*i;return s*=m,h*=m,l*=m,d*=2,v*=2,M*=2,t[0]=u+s+d,t[1]=c+h+v,t[2]=f+l+M,t}function En(t,n,r,e){var o=[],a=[];return o[0]=n[0]-r[0],o[1]=n[1]-r[1],o[2]=n[2]-r[2],a[0]=o[0],a[1]=o[1]*Math.cos(e)-o[2]*Math.sin(e),a[2]=o[1]*Math.sin(e)+o[2]*Math.cos(e),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function On(t,n,r,e){var o=[],a=[];return o[0]=n[0]-r[0],o[1]=n[1]-r[1],o[2]=n[2]-r[2],a[0]=o[2]*Math.sin(e)+o[0]*Math.cos(e),a[1]=o[1],a[2]=o[2]*Math.cos(e)-o[0]*Math.sin(e),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function wn(t,n,r,e){var o=[],a=[];return o[0]=n[0]-r[0],o[1]=n[1]-r[1],o[2]=n[2]-r[2],a[0]=o[0]*Math.cos(e)-o[1]*Math.sin(e),a[1]=o[0]*Math.sin(e)+o[1]*Math.cos(e),a[2]=o[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Pn(t,n){var r=Wt(t[0],t[1],t[2]),e=Wt(n[0],n[1],n[2]);vn(r,r),vn(e,e);var o=Mn(r,e);return o>1?0:o<-1?Math.PI:Math.acos(o)}function Tn(t){return t[0]=0,t[1]=0,t[2]=0,t}function An(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Rn(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}function Cn(t,n){var r=t[0],e=t[1],o=t[2],a=n[0],i=n[1],u=n[2];return Math.abs(r-a)<=p*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(e-i)<=p*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(o-u)<=p*Math.max(1,Math.abs(o),Math.abs(u))}var jn,In=Jt,Ln=$t,Dn=tn,Fn=fn,Bn=sn,Nn=Gt,Un=hn,qn=(jn=Yt(),function(t,n,r,e,o,a){var i,u;for(n||(n=3),r||(r=0),u=e?Math.min(e*n+r,t.length):t.length,i=r;i<u;i+=n)jn[0]=t[i],jn[1]=t[i+1],jn[2]=t[i+2],o(jn,jn,a),t[i]=jn[0],t[i+1]=jn[1],t[i+2]=jn[2];return t});function kn(t){var n=t[0],r=t[1],e=t[2],o=t[3];return Math.sqrt(n*n+r*r+e*e+o*o)}function Vn(t){var n=t[0],r=t[1],e=t[2],o=t[3];return n*n+r*r+e*e+o*o}!function(){var t,n=(t=new b(4),b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function zn(){var t=new b(4);return b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Hn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Yn(t,n,r){r*=.5;var e=Math.sin(r);return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=Math.cos(r),t}function Xn(t,n){var r=2*Math.acos(n[3]),e=Math.sin(r/2);return e>p?(t[0]=n[0]/e,t[1]=n[1]/e,t[2]=n[2]/e):(t[0]=1,t[1]=0,t[2]=0),r}function Gn(t,n,r){var e=n[0],o=n[1],a=n[2],i=n[3],u=r[0],c=r[1],f=r[2],s=r[3];return t[0]=e*s+i*u+o*f-a*c,t[1]=o*s+i*c+a*u-e*f,t[2]=a*s+i*f+e*c-o*u,t[3]=i*s-e*u-o*c-a*f,t}function Wn(t,n,r){r*=.5;var e=n[0],o=n[1],a=n[2],i=n[3],u=Math.sin(r),c=Math.cos(r);return t[0]=e*c+i*u,t[1]=o*c+a*u,t[2]=a*c-o*u,t[3]=i*c-e*u,t}function Qn(t,n,r){r*=.5;var e=n[0],o=n[1],a=n[2],i=n[3],u=Math.sin(r),c=Math.cos(r);return t[0]=e*c-a*u,t[1]=o*c+i*u,t[2]=a*c+e*u,t[3]=i*c-o*u,t}function Zn(t,n,r){r*=.5;var e=n[0],o=n[1],a=n[2],i=n[3],u=Math.sin(r),c=Math.cos(r);return t[0]=e*c+o*u,t[1]=o*c-e*u,t[2]=a*c+i*u,t[3]=i*c-a*u,t}function Kn(t,n){var r=n[0],e=n[1],o=n[2];return t[0]=r,t[1]=e,t[2]=o,t[3]=Math.sqrt(Math.abs(1-r*r-e*e-o*o)),t}function Jn(t,n,r,e){var o,a,i,u,c,f=n[0],s=n[1],h=n[2],l=n[3],d=r[0],v=r[1],M=r[2],m=r[3];return(a=f*d+s*v+h*M+l*m)<0&&(a=-a,d=-d,v=-v,M=-M,m=-m),1-a>p?(o=Math.acos(a),i=Math.sin(o),u=Math.sin((1-e)*o)/i,c=Math.sin(e*o)/i):(u=1-e,c=e),t[0]=u*f+c*d,t[1]=u*s+c*v,t[2]=u*h+c*M,t[3]=u*l+c*m,t}function $n(t){var n=y(),r=y(),e=y(),o=Math.sqrt(1-n),a=Math.sqrt(n);return t[0]=o*Math.sin(2*Math.PI*r),t[1]=o*Math.cos(2*Math.PI*r),t[2]=a*Math.sin(2*Math.PI*e),t[3]=a*Math.cos(2*Math.PI*e),t}function tr(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],i=r*r+e*e+o*o+a*a,u=i?1/i:0;return t[0]=-r*u,t[1]=-e*u,t[2]=-o*u,t[3]=a*u,t}function nr(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function rr(t,n){var r,e=n[0]+n[4]+n[8];if(e>0)r=Math.sqrt(e+1),t[3]=.5*r,r=.5/r,t[0]=(n[5]-n[7])*r,t[1]=(n[6]-n[2])*r,t[2]=(n[1]-n[3])*r;else{var o=0;n[4]>n[0]&&(o=1),n[8]>n[3*o+o]&&(o=2);var a=(o+1)%3,i=(o+2)%3;r=Math.sqrt(n[3*o+o]-n[3*a+a]-n[3*i+i]+1),t[o]=.5*r,r=.5/r,t[3]=(n[3*a+i]-n[3*i+a])*r,t[a]=(n[3*a+o]+n[3*o+a])*r,t[i]=(n[3*i+o]+n[3*o+i])*r}return t}function er(t,n,r,e){var o=.5*Math.PI/180;n*=o,r*=o,e*=o;var a=Math.sin(n),i=Math.cos(n),u=Math.sin(r),c=Math.cos(r),f=Math.sin(e),s=Math.cos(e);return t[0]=a*c*s-i*u*f,t[1]=i*u*s+a*c*f,t[2]=i*c*f-a*u*s,t[3]=i*c*s+a*u*f,t}function or(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var ar,ir,ur,cr,fr,sr,hr=function(t){var n=new b(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},lr=function(t,n,r,e){var o=new b(4);return o[0]=t,o[1]=n,o[2]=r,o[3]=e,o},dr=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},vr=function(t,n,r,e,o){return t[0]=n,t[1]=r,t[2]=e,t[3]=o,t},Mr=function(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t},mr=Gn,pr=function(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t},br=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]},yr=function(t,n,r,e){var o=n[0],a=n[1],i=n[2],u=n[3];return t[0]=o+e*(r[0]-o),t[1]=a+e*(r[1]-a),t[2]=i+e*(r[2]-i),t[3]=u+e*(r[3]-u),t},gr=kn,xr=gr,Sr=Vn,_r=Sr,Er=function(t,n){var r=n[0],e=n[1],o=n[2],a=n[3],i=r*r+e*e+o*o+a*a;return i>0&&(i=1/Math.sqrt(i)),t[0]=r*i,t[1]=e*i,t[2]=o*i,t[3]=a*i,t},Or=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]},wr=function(t,n){var r=t[0],e=t[1],o=t[2],a=t[3],i=n[0],u=n[1],c=n[2],f=n[3];return Math.abs(r-i)<=p*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(e-u)<=p*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(o-c)<=p*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-f)<=p*Math.max(1,Math.abs(a),Math.abs(f))},Pr=(ar=Yt(),ir=Wt(1,0,0),ur=Wt(0,1,0),function(t,n,r){var e=Mn(n,r);return e<-.999999?(mn(ar,ir,n),Nn(ar)<1e-6&&mn(ar,ur,n),vn(ar,ar),Yn(t,ar,Math.PI),t):e>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(mn(ar,n,r),t[0]=ar[0],t[1]=ar[1],t[2]=ar[2],t[3]=1+e,Er(t,t))}),Tr=(cr=zn(),fr=zn(),function(t,n,r,e,o,a){return Jn(cr,n,o,a),Jn(fr,r,e,a),Jn(t,cr,fr,2*a*(1-a)),t}),Ar=(sr=g(),function(t,n,r,e){return sr[0]=r[0],sr[3]=r[1],sr[6]=r[2],sr[1]=e[0],sr[4]=e[1],sr[7]=e[2],sr[2]=-n[0],sr[5]=-n[1],sr[8]=-n[2],Er(t,rr(t,sr))}),Rr=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return a.fromValues(t,n,r)},Cr=function(t,n,r,e){return i.fromValues(t,n,r,e)},jr=function(){return o.create()},Ir=function(t,n,r){return a.add(t,n,r)},Lr=function(t,n,r){return o.multiply(t,n,r)},Dr=function(t,n,r,e){return o.fromRotationTranslationScale(t,n,r,e)};function Fr(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var Br=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.parent=null,this.children=[],this.position=Rr(),this.scaling=Rr(1,1,1),this.quaternion=Cr(0,0,0,1),this.transformDirty=!1,this.modelMatrix=jr()}var n,r,e;return n=t,(r=[{key:"addChild",value:function(t){t.parent=this,this.children.push(t)}},{key:"getChildren",value:function(){for(var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).recursive,n=[],r=0;r<this.children.length;r++){var e=this.children[r];if(n.push(e),t){var o=e.getChildren({recursive:t});n=n.concat(o)}}return n}},{key:"translate",value:function(t,n,r){this.position=Ir(this.position,this.position,Rr(t,n,r)),this.transformDirty=!0}},{key:"scale",value:function(t,n,r){this.scaling=Ir(this.scaling,this.scaling,Rr(t,n,r)),this.transformDirty=!0}},{key:"rotate",value:function(t,n,r){var e,o,a,u=function(t,n,r,e){return i.fromEuler(t,n,r,e)}(Cr(),t,n,r);this.quaternion=(e=this.quaternion,o=this.quaternion,a=u,i.multiply(e,o,a)),this.transformDirty=!0}},{key:"computeModelMatrix",value:function(t){var n=this.position,r=this.scaling,e=this.quaternion;if(t)if(this.transformDirty){var o=Dr(jr(),e,n,r);this.modelMatrix=Lr(this.modelMatrix,t,o)}else this.modelMatrix=Lr(this.modelMatrix,t,this.modelMatrix);else this.transformDirty&&(this.modelMatrix=Dr(this.modelMatrix,e,n,r));for(var a=0;a<this.children.length;a++)t||this.transformDirty?this.children[a].computeModelMatrix(this.modelMatrix):this.children[a].computeModelMatrix()}}])&&Fr(n.prototype,r),e&&Fr(n,e),t}();function Nr(t){return(Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ur(t,n){return!n||"object"!==Nr(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function qr(t){return(qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kr(t,n){return(kr=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var Vr=function(t){function n(t){var r,e=t.name,o=t.geometry,a=t.materials;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(r=Ur(this,qr(n).call(this))).name=e,r.geometry=o,r.materials=a,r}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&kr(t,n)}(n,Br),n}();function zr(t){return(zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hr(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function Yr(t,n){return!n||"object"!==zr(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function Xr(t){return(Xr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gr(t,n){return(Gr=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var Wr=function(t){function n(){var t;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(t=Yr(this,Xr(n).call(this))).upVector=Rr(0,1,0),t.viewMatrix=jr(),t.projectionMatrix=jr(),t}var r,e,a;return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&Gr(t,n)}(n,Br),r=n,(e=[{key:"lookAt",value:function(t,n,r){this.viewMatrix=function(t,n,r,e){return o.lookAt(t,n,r,e)}(this.viewMatrix,this.position,Rr(t,n,r),this.upVector)}}])&&Hr(r.prototype,e),a&&Hr(r,a),n}();function Qr(t){return(Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zr(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function Kr(t,n){return!n||"object"!==Qr(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function Jr(t){return(Jr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $r(t,n){return($r=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var te=function(t){function n(t,r,e,o,a,i){var u;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(u=Kr(this,Jr(n).call(this))).left=t,u.right=r,u.bottom=e,u.top=o,u.near=a,u.far=i,u.updateProjectionMatrix(t,r,e,o,a,i),u}var r,e,a;return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&$r(t,n)}(n,Wr),r=n,(e=[{key:"updateProjectionMatrix",value:function(t,n,r,e,a,i){this.left=t,this.right=n,this.bottom=r,this.top=e,this.near=a,this.far=i,this.projectionMatrix=function(t,n,r,e,a,i,u){return o.ortho(t,n,r,e,a,i,u)}(this.projectionMatrix,t,n,r,e,a,i)}}])&&Zr(r.prototype,e),a&&Zr(r,a),n}();function ne(t){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function re(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function ee(t,n){return!n||"object"!==ne(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function oe(t){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ae(t,n){return(ae=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var ie=function(t){function n(t,r,e,o){var a;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(a=ee(this,oe(n).call(this))).fov=t,a.aspect=r,a.near=e,a.far=o,a.updateProjectionMatrix(t,r,e,o),a}var r,e,a;return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&ae(t,n)}(n,Wr),r=n,(e=[{key:"updateProjectionMatrix",value:function(t,n,r,e){this.fov=t,this.aspect=n,this.near=r,this.far=e,this.projectionMatrix=function(t,n,r,e,a){return o.perspective(t,n,r,e,a)}(this.projectionMatrix,t,n,r,e)}}])&&re(r.prototype,e),a&&re(r,a),n}();function ue(t){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ce(t,n){return!n||"object"!==ue(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function fe(t){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function se(t,n){return(se=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var he=function(t){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.name,e=t.indices;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),ce(this,fe(n).call(this,{name:r,indices:e}))}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&se(t,n)}(n,c),n}(),le=function(t){var n=t.floatPrecision,r=t.intPrecision,e="precision ".concat(n," float;\n"),o=function(t){return"precision ".concat(t," int;\n\n")}(r);return"".concat("#version 300 es\n\n").concat(e).concat(o)},de=function(t){return Object.keys(t).filter(function(n){return t[n]}).map(function(n){return"uniform ".concat(t[n]," ").concat(n,";")}).join("\n")};function ve(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},e=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.forEach(function(n){Me(t,n,r[n])})}return t}function Me(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function me(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var pe=function(){function t(n,r,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.domNode=n,this.scene=r,this.camera=e,this.createAndAppendCanvas(),this.gl=this.canvas.getContext("webgl2")}var n,r,a;return n=t,a=[{key:"getShaderSourceForMaterial",value:function(n){var r=t.SHADER_FLOAT_PRECISION_DEFAULT,e=t.SHADER_INT_PRECISION_DEFAULT,o=t.SHADER_POSITION_LOCATION,a=t.SHADER_NORMAL_LOCATION,i=t.SHADER_UV_LOCATION,u=t.SHADER_VERTEXCOLOR_LOCATION,c=n.material,f={floatPrecision:r,intPrecision:e,positionLocation:o,normalLocation:a,uvLocation:i,vertexColorLocation:u,hasPositions:n.hasPositions,hasNormals:n.hasNormals,hasUvs:n.hasUvs,hasVertexColors:n.hasVertexColors},s={vertexShader:{modelMatrix:"mat4",viewMatrix:"mat4",projectionMatrix:"mat4",normalMatrix:"mat3",mvp:"mat4"},fragmentShader:{}};if(c.diffuseTexture&&(s.fragmentShader.diffuseTexture="sampler2D"),c instanceof he)return function(t){var n=t.floatPrecision,r=t.intPrecision,e=t.positionLocation,o=t.vertexColorLocation,a=t.uniforms,i=a.vertexShader,u=a.fragmentShader,c="\n        layout(location = ".concat(e,") in vec3 position;\n        layout(location = ").concat(o,") in vec4 vertexColor;\n\n        ").concat(de(i),"\n\n        out vec4 vColor;\n\n        void main() {\n            vColor = vertexColor;\n            gl_Position = mvp * vec4(position, 1.0);\n        }\n    "),f="\n        in vec4 vColor;\n\n        ".concat(de(u),"\n\n        out vec4 color;\n\n        void main() {\n            color = vColor;\n        }\n    ");return{vertexShaderSource:"".concat(le({floatPrecision:n,intPrecision:r})).concat(c),fragmentShaderSource:"".concat(le({floatPrecision:n,intPrecision:r})).concat(f)}}(ve({},f,{uniforms:s}));if(c instanceof d)return function(t){var n=t.floatPrecision,r=t.intPrecision,e=t.positionLocation,o=t.normalLocation,a=t.uvLocation,i=t.uniforms,u=i.vertexShader,c=i.fragmentShader,f="\n        layout(location = ".concat(e,") in vec3 position;\n        layout(location = ").concat(o,") in vec3 normal;\n        layout(location = ").concat(a,") in vec2 uv;\n\n        ").concat(de(u),"\n\n        out vec3 vPosition;\n        out vec3 vNormal;\n        out vec2 vUv;\n\n        void main() {\n            vUv = uv;\n            vNormal = normalMatrix * normal;\n            vPosition = (modelMatrix * vec4( position, 1.0 )).xyz;\n            // gl_Position = mvp * vec4(position, 1.0);\n            gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.0);\n        }\n    "),s="\n        in vec3 vPosition;\n        in vec3 vNormal;\n        in vec2 vUv;\n\n        ".concat(de(c),"\n\n        // This is needed to figure out the specular highlight\n        vec3 cameraPosition;\n        // The model color\n        vec4 color;\n        // The model's specular color\n        vec4 specularColor;\n        // The amount of ambient light\n        float ambientLight;\n        \n        // The specular values passed in from the shader\n        float specularAmount;\n        float specularShininess;\n        \n        // The lights\n        vec3 light;\n\n        out vec4 fragmentColor;\n\n        void main() {\n            cameraPosition = vec3(0, 5.0, 10.0);\n            color = vec4(1.0, 0.0, 0.0, 1.0);\n            specularColor = vec4(1.0, 1.0, 1.0, 1.0);\n            ambientLight = 1.0;\n            specularAmount = 0.5;\n            specularShininess = 50.0;\n            light = normalize(vec3(0.0, 5.0, 10.0));\n\n            // Get the direction from the surface to the camera, which is located at\n            // (0,-1,0) in clip space. The camera position is hardcoded for convenience.\n            vec3 directionToCamera = normalize(cameraPosition - vPosition);\n\n            // Find the vector pointing halfway between the directions\n            // of the camera and light from this point on the surface\n            vec3 halfwayVector = normalize( directionToCamera + light );\n\n            // Calculate the specular highlight\n            float specularBrightness = (\n              \n              specularAmount * // Adjust the overall amount of specular light\n              // Find the angle between the normal and the halfwayVector by taking\n              // the dot product, and then raise it to a certain power. The power\n              // increases or decreases the size of the bright spot.\n              pow(\n                max(0.0, dot(vNormal, halfwayVector)),\n                specularShininess\n              )\n            );\n            \n            // Calculate the brightness of the surface using the lambertian lighting model\n            float lightDotProduct = dot( normalize(vNormal), light );\n            float surfaceBrightness = max( 0.0, lightDotProduct );\n\n            // fragmentColor = texture(diffuseTexture, vUv);\n            \n            // Multiply together all of the various light values\n            fragmentColor = vec4(texture(diffuseTexture, vUv).xyz * surfaceBrightness + specularColor.xyz * specularBrightness, color.w);\n        }\n    ");return{vertexShaderSource:"".concat(le({floatPrecision:n,intPrecision:r})).concat(f),fragmentShaderSource:"".concat(le({floatPrecision:n,intPrecision:r})).concat(s)}}(ve({},f,{uniforms:s}));throw new Error("Cannot render Material")}}],(r=[{key:"createAndAppendCanvas",value:function(){this.canvas=document.createElement("canvas"),this.domNode.appendChild(this.canvas),this.canvas.style.position="relative",this.canvas.style.top="0px",this.canvas.style.left="0px",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.width=this.domNode.clientWidth,this.canvas.height=this.domNode.clientHeight}},{key:"resize",value:function(){this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.gl.viewport(0,0,this.canvas.width,this.canvas.height)}},{key:"createShader",value:function(t,n){var r=this.gl,e=r.createShader(t);if(r.shaderSource(e,n),r.compileShader(e),r.getShaderParameter(e,r.COMPILE_STATUS))return e;console.error(r.getShaderInfoLog(e)),r.deleteShader(e)}},{key:"createProgram",value:function(t,n){var r=this.gl,e=r.createProgram();if(r.attachShader(e,t),r.attachShader(e,n),r.linkProgram(e),r.getProgramParameter(e,r.LINK_STATUS))return e;console.error(r.getProgramInfoLog(e)),r.deleteProgram(e)}},{key:"createTexture",value:function(t){var n=this.gl,r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r);var e=n.RGBA,o=n.RGBA,a=n.UNSIGNED_BYTE;return n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,e,o,a,t),n.generateMipmap(n.TEXTURE_2D),r}},{key:"createArrayBuffer",value:function(n,r){var e,o=this.gl,a=(Me(e={},t.BUFFER_TYPE_POSITION,function(n){return{loc:t.SHADER_POSITION_LOCATION,bufferData:n.getPositionsBuffer(),bufferSize:n.getPositionsBufferSize()}}),Me(e,t.BUFFER_TYPE_NORMAL,function(n){return{loc:t.SHADER_NORMAL_LOCATION,bufferData:n.getNormalsBuffer(),bufferSize:n.getNormalsBufferSize()}}),Me(e,t.BUFFER_TYPE_UV,function(n){return{loc:t.SHADER_UV_LOCATION,bufferData:n.getUvsBuffer(),bufferSize:n.getUvsBufferSize()}}),Me(e,t.BUFFER_TYPE_VERTEXCOLOR,function(n){return{loc:t.SHADER_VERTEXCOLOR_LOCATION,bufferData:n.getVertexColorsBuffer(),bufferSize:n.getVertexColorsBufferSize()}}),e)[n](r),i=a.loc,u=a.bufferData,c=a.bufferSize,f=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,f),o.bufferData(o.ARRAY_BUFFER,u,o.STATIC_DRAW),o.enableVertexAttribArray(i),o.vertexAttribPointer(i,c,o.FLOAT,!1,0,0)}},{key:"createVertexArray",value:function(n){var r=this.gl,e=r.createVertexArray();return r.bindVertexArray(e),n.positions.length>0&&this.createArrayBuffer(t.BUFFER_TYPE_POSITION,n),n.normals.length>0&&this.createArrayBuffer(t.BUFFER_TYPE_NORMAL,n),n.uvs.length>0&&this.createArrayBuffer(t.BUFFER_TYPE_UV,n),n.vertexColors.length>0&&this.createArrayBuffer(t.BUFFER_TYPE_VERTEXCOLOR,n),e}},{key:"createElementArrayBuffer",value:function(t){var n=this.gl,r=n.createBuffer();return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.getIndicesBuffer(),n.STATIC_DRAW),r}},{key:"init",value:function(){var n=this.gl;n.viewport(0,0,n.canvas.width,n.canvas.height),n.clearColor(0,0,0,1),n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL),this.sceneChildren=this.scene.getChildren({recursive:!0}),this.shaders=[],this.vaos=[],this.indicesBuffers=[],this.uniforms=[],this.textures=[];for(var r=0;r<this.sceneChildren.length;r++){var e=this.sceneChildren[r];this.shaders[r]=[],this.uniforms[r]=[],this.indicesBuffers[r]=[],this.textures[r]=[],this.vaos[r]=this.createVertexArray(e.geometry);for(var o=0;o<e.materials.length;o++){var a=e.materials[o];this.indicesBuffers[r][o]=this.createElementArrayBuffer(a);var i={material:a},u=t.getShaderSourceForMaterial(i),c=u.vertexShaderSource,f=u.fragmentShaderSource,s=this.createShader(n.VERTEX_SHADER,c),h=this.createShader(n.FRAGMENT_SHADER,f);this.shaders[r][o]=this.createProgram(s,h),this.uniforms[r][o]={modelMatrix:n.getUniformLocation(this.shaders[r][o],"modelMatrix"),viewMatrix:n.getUniformLocation(this.shaders[r][o],"viewMatrix"),projectionMatrix:n.getUniformLocation(this.shaders[r][o],"projectionMatrix"),normalMatrix:n.getUniformLocation(this.shaders[r][o],"normalMatrix"),mvp:n.getUniformLocation(this.shaders[r][o],"mvp")},!!a.diffuseTexture&&(this.textures[r][o]=this.createTexture(a.diffuseTexture),this.uniforms[r][o].diffuseTexture=n.getUniformLocation(this.shaders[r][o],"diffuseTexture"))}}}},{key:"render",value:function(){var t=this.gl;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.scene.computeModelMatrix();for(var n=0;n<this.sceneChildren.length;n++){var r=this.sceneChildren[n],a=o.multiply(o.create(),this.camera.viewMatrix,r.modelMatrix),i=o.multiply(o.create(),this.camera.projectionMatrix,a),u=e.normalFromMat4(e.create(),a);t.bindVertexArray(this.vaos[n]);for(var c=0,f=r.materials.length;c<f;c++){var s=r.materials[c];t.useProgram(this.shaders[n][c]),t.uniformMatrix4fv(this.uniforms[n][c].modelMatrix,!1,r.modelMatrix),t.uniformMatrix4fv(this.uniforms[n][c].viewMatrix,!1,this.camera.viewMatrix),t.uniformMatrix4fv(this.uniforms[n][c].projectionMatrix,!1,this.camera.projectionMatrix),t.uniformMatrix3fv(this.uniforms[n][c].normalMatrix,!1,u),t.uniformMatrix4fv(this.uniforms[n][c].mvp,!1,i),!!s.diffuseTexture&&(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.textures[n][c]),t.uniform1i(this.uniforms[n][c].diffuseTexture,0)),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffers[n][c]),t.drawElements(t.TRIANGLES,s.getIndicesLength(),t.UNSIGNED_INT,0)}}}}])&&me(n.prototype,r),a&&me(n,a),t}();pe.SHADER_POSITION_LOCATION=0,pe.SHADER_NORMAL_LOCATION=1,pe.SHADER_UV_LOCATION=2,pe.SHADER_VERTEXCOLOR_LOCATION=3,pe.BUFFER_TYPE_POSITION="position",pe.BUFFER_TYPE_NORMAL="normal",pe.BUFFER_TYPE_UV="uv",pe.BUFFER_TYPE_VERTEXCOLOR="vertexColor",pe.SHADER_PRECISION_HIGH="highp",pe.SHADER_PRECISION_MEDIUM="mediump",pe.SHADER_PRECISION_LOW="lowp",pe.SHADER_FLOAT_PRECISION_DEFAULT=pe.SHADER_PRECISION_MEDIUM,pe.SHADER_INT_PRECISION_DEFAULT=pe.SHADER_PRECISION_MEDIUM;var be=pe;r.d(n,"BlinnPhongMaterial",function(){return d}),r.d(n,"Geometry",function(){return M}),r.d(n,"ImageLoader",function(){return m}),r.d(n,"Material",function(){return c}),r.d(n,"Mesh",function(){return Vr}),r.d(n,"Node",function(){return Br}),r.d(n,"OrthographicCamera",function(){return te}),r.d(n,"PerspectiveCamera",function(){return ie}),r.d(n,"VertexColorMaterial",function(){return he}),r.d(n,"WebGL2Renderer",function(){return be})}})});