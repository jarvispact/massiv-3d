<!doctype html>
<html lang="de">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
        <title>hello-world</title>
        <style type="text/css">
            #canvas {
                position: fixed;
                top: 0px;
                left: 0px;
                width: 100%;
                height: 100%;
                overflow: hidden;
            }
        </style>
    </head>

    <body>
        <canvas id="canvas"></canvas>
        <script type="module">
            import * as MASSIV from './massiv.mjs';

            const world = new MASSIV.World();

            const spaceShip = world.registerEntity([
                new MASSIV.Transform({ position: [0, 0, 0] }),
                new MASSIV.Component('Velocity', { foo: 'bar' }),
                new MASSIV.Component('Acceleration', { foo: 'bar' }),
            ]);

            const asteroid = world.registerEntity([
                new MASSIV.Transform({ position: [0, 0, 0] }),
                new MASSIV.Component('Velocity', { foo: 'bar' }),
                new MASSIV.Component('Acceleration', { foo: 'bar' }),
            ]);

            const CustomSystem = class extends MASSIV.System {
                constructor() {
                    super('CustomSystem', world);
                    console.log('CustomSystem constructor called');
                }
            }

            const CustomUpdateableSystem = class extends MASSIV.UpdateableSystem {
                constructor() {
                    super('CustomUpdateableSystem', world);
                    console.log('CustomUpdateableSystem constructor called');
                }

                onUpdate(delta) {
                    console.log(`CustomUpdateableSystem ${delta}`);
                    
                }
            }

            world.registerSystem(MASSIV.UpdateTransformSystem);
            world.registerSystem(CustomSystem);
            world.registerSystem(CustomUpdateableSystem);
            console.log(world);

            // const createGetDelta = (then = 0) => (now) => {
            //     now *= 0.001;
            //     const delta = now - then;
            //     then = now;
            //     return delta;
            // };

            // const getDelta = createGetDelta();

            // const tick = (now) => {
            //     world.update(getDelta(now));
            //     requestAnimationFrame(tick);
            // };

            // requestAnimationFrame(tick);
        </script>
    </body>
</html>
